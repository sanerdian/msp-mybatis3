<!-- <link rel="stylesheet" href="../../../thirdparty/tree/css/metroStyle/metroStyle.css"> -->
<script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<!--<script src="tree/js/jquery-1.4.4.min.js"></script>-->
<!--<script src="tree/js/jquery.ztree.all.min.js"></script>-->
<!-- <script src="../../../thirdparty/jquery/jquery-2.2.2.min.js"></script> -->
<!-- <script src="../../../thirdparty/tree/js/jquery.ztree.all.min.js"></script> -->
<link rel="stylesheet" href="../../../common/css/column.css">
<script src="../../../common/js/column_new.js"></script>
<script src="../../../common/js/video.js"></script>
<style>
    #nav span, .right span {
        display: none;
    }

    #nav a {
        display: inline-block;
        width: 40px;
        height: 56px;
        text-align: center;
        border: 1px solid #f5f5f5;
    }

    #nav a:nth-of-type(3) {
        display: inline-block;
        width: 220px;
        height: 52px;
        text-align: left;
        padding-left: 20px;
        border-top: 2px solid #000;
        font-weight: bold;
    }

    .img-box-right {
        display: inline-block;
        position: absolute;
        top: 0;
        right: 0;
    }

    .layui-breadcrumb a {
        color: #000 !important;
    }

    #nav span,
    .right span {
        display: none;
    }

    .layui-form-radio * {
        color: #000;
    }

    #nav a {
        display: inline-block;
        width: 40px;
        height: 56px;
        text-align: center;
        border: 1px solid #f5f5f5;
    }

    #nav a:nth-of-type(3) {
        display: inline-block;
        width: 220px;
        height: 52px;
        text-align: left;
        padding-left: 20px;
        border-top: 2px solid #000;
        font-weight: bold;
    }

    .img-box-right {
        display: inline-block;
        position: absolute;
        top: 0;
        right: 0;
    }

    .layui-breadcrumb a {
        color: #000 !important;
    }

    .ztree li {
        margin-top: 10px;
        padding: 0;
    }

    .ztree li span.button.noline_close {
        background-position: -130px -88px;
    }

    #list1 .layui-table td {
        padding: 0;
    }

    .imgBox {
        margin-top: 20px;
        margin-left: 30px;
    }

    .imgBox li {
        width: 230px;
        height: 165px;
        background: url(../../common/img/transparent.gif) no-repeat;
        background-size: 100% 100%;
        float: left;
        margin-right: 25px;
        margin-bottom: 20px;
    }

    .imgBox li .img {
        width: 240px;
        height: 135px;
        /*background: url(./img/u6147.png) no-repeat;*/
        background-size: 100% 100%;
        position: relative;
    }

    .imgBox1 li {
        width: 100%;
        height: 115px;
        border-bottom: 1px solid #f5f5f5;
        position: relative;
    }

    .imgBox1 li .img-box-right {
        width: 140px;
        height: 70px;
        /*background: url(./img/u6147.png) no-repeat;*/
        background-size: 100% 100%;
        position: absolute;
        top: 10px;
        left: 15px;
    }

    .imgIcon {
        display: inline-block;
        width: 110px;
        height: 75px;
        border: 1px solid #000;
    }

    .imgBox1 li .content {
        height: 70px;
        position: absolute;
        top: 10px;
        left: 175px;
    }

    .layui-table tbody tr:hover {
        background: #fff;
    }

    td .layui-input, .layui-select, .layui-textarea {
        border: none;
    }

    .inner1 li {
        float: left;
        margin-left: 15px;
    }

    .inner1 li:last-child {
        width: 175px;
        height: 197px;
        background: #f6f6f6;
        margin-top: 10px;
        position: relative;
    }

    .inner1 li:last-child img {
        position: absolute;
        top: 40px;
        left: 30px;
    }

    #test11 i {
        display: none;
    }

    #test11 .layui-colorpicker {
        width: 38px;
        height: 38px;
        padding: 0;
    }

    #form2 .layui-form-select .layui-edge, #form3 .layui-form-select .layui-edge {
        position: absolute;
        right: 10px;
        top: 75%;
    }

    .box {
        width: 1350px;
        height: 690px;
        background: #fff;
        padding: 10px 0 0 10px;
    }

    .layui-layer-hui .layui-layer-content {
        padding: 0 25px;
    }

    .prev {
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: #ccc;
        position: absolute;
        line-height: 60px;
        top: 250px;
        left: 30px;
    }

    .next {
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: #ccc;
        position: absolute;
        line-height: 60px;
        top: 250px;
        right: 30px;
    }

    .image {
        width: 600px;
        height: 464px;

        background-size: 100% 100%;
    }

    #play .control {
        position: absolute;
        background: rgba(0, 0, 0, 0.3);
        width: 400px;
        height: 40px;
        border-radius: 5px;
        left: 50%;
        bottom: 70px;
        transform: translateX(-50%);
    }

    #play .control div {
        display: inline-block;
        line-height: 40px;
        margin-left: 10px;
        font-size: 18px;
        color: #fff;
    }

    #play .control .play_pause, .player .control .expand {
        color: rgb(255, 255, 0);
    }

    #play .control div:nth-child(2) {
        width: 260px;
        height: 10px;
        background-color: rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        overflow: hidden;
    }

    #play .control .progress {
        display: inline-block;
        width: 60%;
        height: 10px;
        background: #fff;
    }

    #play .control .timer {
        font-size: 12px;
    }

    .left {
        float: left;
        width: 600px;
        margin: 50px 50px 0 50px;
    }

    .rights {
        float: left;
        margin-left: 50px;
    }

    .layui-layer-hui {
        background: rgba(0, 0, 0, 0);
    }

    .node_name {
        font-size: 14px;
    }

    .videos {
        display: none;
        width: 795px;
        height: 464px;
        background: url(../../common/img/u6147.png) no-repeat;
        background-size: 100% 100%;
        position: absolute;
        top: 0;
        left: 0
    }

    #title li {
        width: 167px;
        border: 1px solid #ccc;
    }

    #box {
        width: 160px;
        height: 80px;
        background: #fff;
        display: none;
        position: absolute;
        right: 183px;
        top: 58px;
        box-shadow: 0px 0px 5px #888888;
        border: 1px solid #000;
    }

    #box li {
        width: 150px;
        height: 40px;
        line-height: 40px;
        padding-left: 10px;
    }

    .active {
        background: #cccccc;
    }

    .ztree {
        width: auto;
        overflow-y: hidden;
    }

    .layui-card-body {
        padding: 0;
    }

    .layui-card-header {
        padding: 0 12px;
    }

    /* 转发 审核按钮 */

    .layui-layer-btn .layui-layer-btn0,
    .layui-layer-btn .layui-layer-btn1 {
        border: 1px solid #029687;
        padding: 2px 21px;
    }

    .layui-layer-btn .layui-layer-btn0 {
        background: #029687;
    }

    .tuisong .layui-input-block {
        margin-left: 0;
    }

    .tuisong .layui-inline {
        display: block;
    }

    #search {
        margin-right: 10px;
        margin-left: 10px;
    }

    .drwb {
        color: #333;
    }
</style>


<div class="layui-fluid">
    <div class="layui-row layui-col-space12">
        <div class="layui-col-md3 md2-left h100">
            <div class="layui-card">
                <div class="layui-card-header">视频管理
                    <!--<button class="layui-btn layui-btn-sm" style="float: right;margin-top: 5px;" data-method="setting">设置</button></div>-->
                    <img src="../../../common/img/u7869.png" alt="" style="float: right;margin-top: 12px ;cursor: pointer" onclick="setting()">
                    <div class="layui-card-body">
                        <ul id="treeDemo" class="ztree"></ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-col-md9 md2-right">
            <div class="layui-card h100">
                <div class="layui-card-body">
                    <div class="layui-tab layui-tab-card" style="width: 1330px">
                        <div class="layui-tab-content" style="height: 735px;">
                            <div class="layui-tab-item layui-show">
                                <div class="layui-card h100" id='list1' style="height: 700px;">
                                    <form class="layui-form" style="display: inline-block;margin-top: 10px;">
                                        <div class="layui-form-item" style="display: inline-block;">
                                            <label class="layui-form-label"
                                                   style="padding:  9px 0px 9px 15px;width:30px;text-align:center">名称</label>
                                            <div class="layui-input-block" style="width: 90px;margin-left: 55px;">
                                                <input type="text" class="layui-input" placeholder="请输入" id="name">
                                            </div>
                                        </div>
                                        <div class="layui-form-item" style="display: inline-block;">
                                            <label class="layui-form-label"
                                                   style="padding: 9px 0 9px 15px;width:45px;text-align:center">创建者</label>
                                            <div class="layui-input-block" style="width: 90px;margin-left: 65px;">
                                                <input type="text" class="layui-input" placeholder="请输入" id="crUser">
                                            </div>
                                        </div>
                                        <div class="layui-form-item" style="display: inline-block;">
                                            <label class="layui-form-label"
                                                   style="padding: 9px 0 9px 15px;width:56px;text-align:center">上传时间</label>
                                            <div class="layui-input-block" style="width: 170px;margin-left: 75px;">
                                                <input type="text" class="layui-input" id="t12" placeholder=" - " style="text-align: center">
                                            </div>
                                        </div>
                                    </form>
                                    <div class="layui-btn-container"
                                         style="display: inline-block;width: 765px;">
                                        <button class="layui-btn" id="search" onclick="search()"><i
                                                class="layui-icon layui-icon-search"></i></button>
                                        <!--                                        <button class="layui-btn" id="unpassAll">转发</button>-->
                                        <!--                                        <button class="layui-btn" id="passAll">审核</button>-->
                                        <button class="layui-btn" onclick="deleteVideos()">批量删除</button>
                                        <!--                                        <button class="layui-btn" onclick="createCodes()">资源发布</button>-->
                                        <!--                                        <button class="layui-btn" onclick="zCode()">批量转码</button>-->
                                        <!--<button class="layui-btn" onclick="addMarks()">批量新建水印</button>-->
                                        <button class="layui-btn" data-method="upload" id="uploads">视频上传</button>
                                    </div>
                                    <ul id="box">
                                        <li><img src="../../../common/img/u7412.png">&nbsp;&nbsp;&nbsp;<span class="txt">直接转码</span></li>
                                        <li><img src="../../../common/img/u7415.png">&nbsp;&nbsp;&nbsp;<span class="txt">进入转码任务</span></li>
                                    </ul>
                                    <div class="layui-form">
                                        <table class="layui-table">
                                            <colgroup>
                                                <col width="130">
                                                <col width="100">
                                                <col width="100">
                                                <col width="100">
                                                <col width="120">
                                                <col>
                                                <col width="40">
                                                <col width="40">
                                            </colgroup>
                                            <tbody>
                                            <tr>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;">
                                                        <select name="" id="">
                                                            <option value="0" selected>默认排序</option>
                                                            <option value="1">上传时间排序</option>
                                                            <option value="2">文件大小排序</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;">
                                                        <select name="form" id="" lay-verify="required">
                                                            <option value="" disabled selected hidden>分辨率</option>
                                                            <option value="1">360p</option>
                                                            <option value="2">720p</option>
                                                            <option value="3">1080p</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;">
                                                        <select name="form" id="" lay-verify="required" lay-filter="forms">
                                                            <option value="" disabled selected hidden>格式</option>
                                                            <option value="全部">全部</option>
                                                            <option value="MP4">MP4</option>
                                                            <option value="AVI">AVI</option>
                                                            <option value="MPG">MPG</option>
                                                            <option value="MKV">MKV</option>
                                                            <option value="其他">其他</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;">
                                                        <select name="form" id="" lay-verify="required">
                                                            <option value="" disabled selected hidden>时长</option>
                                                            <option value="1">全部</option>
                                                            <option value="2">5以内</option>
                                                            <option value="3">5~20</option>
                                                            <option value="4">20~60</option>
                                                            <option value="5">60以上</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;">
                                                        <select id="" lay-verify="required" lay-filter="copyright">
                                                            <option value="" disabled selected hidden>版权归属</option>
                                                            <option value="全部">全部</option>
                                                            <option value="自主">自主</option>
                                                            <option value="经授权">经授权</option>
                                                            <option value="其他">其他</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;">
                                                        <select name="form" id="" lay-verify="required" lay-filter="state">
                                                            <option value="" disabled selected hidden>视频状态</option>
                                                            <option value="0">新稿</option>
                                                            <option value="10">审核</option>
                                                            <option value="20">发布</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="layui-input-block" style="margin-left: 0;width: 140px">
                                                        <select name="form" id="" lay-verify="required" lay-filter="code">
                                                            <option value="" disabled selected hidden>转码状态</option>
                                                            <option value="0">未转码</option>
                                                            <option value="1">已转码</option>
                                                        </select>
                                                    </div>
                                                </td>
                                                <td style="width: 400px"></td>

                                                <td class="img1">
                                                    <img src="../../common/img/u6616_mouseOver.png" alt="" srcset="" style="margin-left: 10px;" id='change1'>
                                                </td>
                                                <td class="img1">
                                                    <img src="../../common/img/u6611.png" alt="" srcset="" style="margin-left: 10px;" id='change2'>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <ul class="imgBox" style="height: 555px;overflow: auto" id="video">


                                        </ul>
                                        <ul class="imgBox1" style="display: none;height: 490px;overflow: auto" id="video1">


                                        </ul>
                                        <div id="page1" style="margin-left:30px;"></div>
                                    </div>
                                </div>
                                <div class="layui-card h100" id="form9" style="display: none;height: 700px"></div>
                                <div class="layui-card h100" id='list2' style="display: none;height: 700px">
                                    <div class="layui-card-header">
                                        <button class="layui-btn" style="float: right" onclick='returnBack()'>返回</button>
                                    </div>
                                    <div class="layui-card-body">
                                        <div class='inner' style="width: 695px;height:234px;margin: 180px auto">
                                            <form class="layui-form" method="post" action="javascript:;">

                                                <div class="layui-form-item">

                                                    <div class="layui-inline">
                                                        <div class="layui-upload-drag" id="chooseFile">
                                                            <p style="width: 265px;position: relative;left: 45px;"><i class="layui-icon layui-icon-upload" style="font-size: 35px"></i>&nbsp;&nbsp;&nbsp;<span
                                                                    style="position: absolute">点击上传</span></p>
                                                            <p style="margin-top:20px; color:#ccc;text-align: center;">--------------------------------------&nbsp;&nbsp;或&nbsp;&nbsp;--------------------------------------</p>
                                                            <p style="margin-top:20px; color:#0000ff;text-align: center;font-size: 20px;">从电脑里拖拽视频至此上传</p>
                                                            <p style="margin-top:20px; color:#ccc;text-align: center;color:#ccc;">支持MP4、AVI、MPG、FLV等格式（批量上传每次上限50个）</p>
                                                        </div>
                                                    </div>

                                                </div>

                                            </form>

                                        </div>
                                    </div>

                                </div>
                                <div class="layui-card h100" id='list3' style="display: none;height: 700px">
                                    <div class="layui-card-header">
                                        <button class="layui-btn" style="float: right" onclick='returnBack1()'>返回</button>
                                    </div>
                                    <div class="layui-card-body">

                                        <div class="inner1">
                                            <div class="layui-main">
                                                <div class="layui-inline" id="upload_preview"></div>
                                            </div>
                                            <form class="layui-form" style="margin-top: 360px">
                                                <div class="layui-form-item">
                                                    <div class="layui-input-block" style="margin-left: 0">
                                                        <input type="checkbox" lay-filter="check" lay-skin="primary" title="按默认设置处理（水印，转码）">
                                                    </div>
                                                </div>
                                            </form>
                                            <div class="edit" style="position: relative">
                                                <button class="layui-btn layui-btn-normal layui-btn-lg" style="width: 265px;margin-top: 10px;display: inline-block;" onclick="editVideo()"><i
                                                        class="layui-icon layui-icon-upload"></i>编辑视频
                                                </button>
                                                <span style="margin-left: 15px;color:#666;display: inline-block;height: 44px;position: absolute;top:10px;line-height: 44px;">共<i id="counts">0</i>条视频（上传过程中请不要删除原始视频）</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-card h100" id='list5' style="display: none;height: 700px">
                                    <div class="layui-card-header">
                                        <button class="layui-btn" style="float: right" onclick='returnBack3()'>返回</button>
                                    </div>
                                    <div class="layui-card-body">
                                        <div class="inner3">
                                            <h3 style="color: #169BD5;margin-left: 500px;margin-top:20px;font-weight:bold;display: inline-block;">单独新建信息</h3>
                                            <div class="infoBox" style="width: 450px;height:620px;border-left:1px solid #ccc;float:right;margin-top: 60px;overflow: auto;">
                                                <form class="layui-form" id='form3' lay-filter="videoInfo">

                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">视频名称</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <input type="text" class="layui-input" placeholder="请输入内容" name="name">
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">*版权归属</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <input type="text" class="layui-input" placeholder="请输入内容" name="copyright">
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">来源</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <input type="text" class="layui-input" placeholder="请输入内容" name="resc">
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">*描述</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <textarea class="layui-textarea" style="border: 1px solid #ccc"></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">文件夹路径</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <input type="text" class="layui-input" placeholder="请输入内容" name="url">
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">格式</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <input type="text" class="layui-input" placeholder="请输入内容" name="form">
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">文件大小</label>
                                                        <div class="layui-input-block" style="width: 320px">
                                                            <input type="text" class="layui-input" name="fsize">
                                                        </div>
                                                    </div>
                                                    <div class="layui-form-item">
                                                        <label class="layui-form-label" style="text-align: left;">分辨率</label>
                                                        <div class="layui-input-block" style="width:320px;">
                                                            <input type="text" class="layui-input" name="reso">
                                                        </div>
                                                    </div>
                                                    <button class="layui-btn layui-btn-normal" style="width: 310px;margin:20px 0 20px 50px;" type="button" lay-submit lay-filter="confirms1">确定</button>

                                                </form>

                                            </div>
                                            <div class="imgIcon" style="width:379px;height:466px;margin: 50px 0 0 150px;position: relative;">
                                                <!-- <img src="./img/u6733.jpg" alt="" srcset="" style="width: 100%;height:100%;"> -->
                                                <video id="mov" style="position: absolute;width: 60px;height: 60px;;position: absolute;top:50%;left:50%;margin: -30px 0 0 -30px;"></video>
                                            </div>
                                            <div class="layui-btn-container" style="margin: 20px 150px;">
                                                <button class="layui-btn layui-btn-normal" style="margin-right: 115px;"><i class="layui-icon layui-icon-left"></i></button>
                                                <button class="layui-btn layui-btn-normal" style="margin-left: 150px;"><i class="layui-icon layui-icon-right"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-card h100" id='list7' style="display: none;height: 700px">
                                    <div class="layui-card-header">
                                        <button class="layui-btn" style="float: right" onclick='returnBack5()'>返回</button>
                                    </div>
                                    <div class="layui-card-body">
                                        <div class="inner5" id="inner5">

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="layui-tab-item" style="position: relative" id="main">
                                <div class="search-bar">
                                    <!-- data-type="showAddColumn -->
                                    <button class="layui-btn" onclick="addImgColumn()">新建栏目</button>
                                    <button class="layui-btn" onclick="editByIds()">修改栏目</button>
                                    <button class="layui-btn" onclick="delColumn2()">删除栏目</button>
                                    <button class="layui-btn" id="import">导入栏目</button>
                                    <button class="layui-btn" style="margin-left:10px;" id="export" onclick="exportExc()">导出栏目</button>
                                    <form class="layui-form" action="" style="display: inline-block;float:right;">
                                        <input type="text" name="title" placeholder="请输入" autocomplete="off" class="layui-input search-input" id="val">
                                        <button class="layui-btn" type="button" onclick="searchColumn()"><i class="layui-icon">&#xe615;</i></button>
                                    </form>
                                </div>
                                <ul class="uls" id="first" style="height: 630px;overflow-y: auto;clear: both;">
                                </ul>
                                <div id="demo8" align="center"></div>
                            </div>
                            <div class="layui-tab-item" id="columnDetail">
                            </div>
                        </div>
                        <ul class="layui-tab-title">
                            <li id="imgTab" class="layui-this">视频管理</li>
                            <li id="columnTab">子栏目管理</li>
                            <li id="infoTab" onclick="getColumnByIds()">基本信息</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="videoList">
    {{# layui.each(d, function(index, item){ }}
    <li style="position: relative">
        <div class="img" style="position: relative">
            {{# var url = getAjaxUrl("",item.url); }}
            <video src="{{url}}"  style="width: 100%;height: 100%" id="videos"></video>
            <!--            <img src="{{url}}" alt="" style="width:100%;height:100%" class="cover">-->
            <!--<div class="layui-btn-container" style="position: absolute;right:0px;top:0px;">-->
            <!--<button class="layui-btn layui-btn-sm "-->
            <!--style="background: #000;">        {{#if(item.collection===0){ }}-->
            <!--<img src= "../../../common/img/u582.png" alt="" onclick="collect('{{item.id}}',event)" style="    width: 25px;-->
            <!--height: 25px;-->
            <!--margin-top: 3px;" >-->
            <!--{{#} else if(item.collection===1){ }}-->
            <!--<img src= "../../../common/img/u582_mouseOver.png" alt="" onclick="collect('{{item.id}}',event)" style="    width: 25px;-->
            <!--height: 25px;-->
            <!--margin-top: 3px;" >-->
            <!--{{#} }}</button>-->
            <!--<button class="layui-btn layui-btn-sm"-->
            <!--style="background: #000;border-radius: 2px" onclick="downLoadVideo('{{item.id}}')">下载</button>-->
            <!--<button class="layui-btn layui-btn-sm"-->
            <!--style="background: #000;border-radius: 2px" onclick="deleteVideo('{{item.id}}')"><i-->
            <!--class="layui-icon layui-icon-delete"></i></button>-->
            <div style="width: 40px;height:40px;position: absolute;top:55px;left:95px;" onclick="preview('{{item.id}}')">
                <img src="../../../common/img/u7603.png" alt="" style="width: 100%;height:100%;">
            </div>
            <p style="position: absolute;bottom:10px;right:10px;color: #FFFFFF">{{item.length}}</p>
            <!--</div>-->
        </div>
        <div class="checkDiv" style="position: absolute;left: 5px;bottom: 0px;">
            <input type="checkbox" name="ids" lay-skin="primary" id="check" lay-filter="checked" value="{{item.id}}">
        </div>

        <div class="text" style="margin-top:10px;height: 20px;overflow: hidden;width: 150px;
text-overflow:ellipsis;white-space: nowrap;float: right;    margin-right: 40px;
    margin-top: 7px;">

            {{#if(item.status===0){ }}
            <span style="color: blue">新稿</span>
            {{#} else if(item.status===10){ }}
            <span style="color: blue">审核</span>
            {{#} else if(item.status===20){ }}
            <span style="color: blue">发布</span>
            {{#} }}
            |&nbsp;&nbsp;<span style="text-align: center" title="{{item.name}}.{{item.form}}">{{item.name}}.{{item.form}}</span>
        </div>
    </li>
    {{#  }); }}
    {{# if(d.length === 0){ }}
    无数据
    {{# } }}
</script>
<script type="text/html" id="videoList1">
    {{# layui.each(d, function(index, item){ }}
    <li>
        <div class="img-box-right">
            {{# var url = getAjaxUrl("",item.url); }}
            <video src="{{url}}"  style="width: 100%;height: 100%"></video>
            <!--            <img src="{{url}}" alt="" style="width:100%;height:100%">-->
            <div style="width: 30px;height:30px;position: absolute;top:0" onclick="preview('{{item.id}}')">
                <img src="../../common/img/u7603.png" alt="" style="width: 230px;height:150px;margin: 15px 0 0 50px;">
            </div>
        </div>
        <div class="content">
            <p> {{item.name}}</p>
            <p style="margin-top: 15px;">
                <span>格式：{{item.form}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>大小：{{item.fsize}}KB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>时长：{{item.length}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>上传时间：{{item.createTime}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>路径：{{item.url}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>来源：{{item.resc}}</span>
            </p>
        </div>
        <!--<div class="layui-btn-container" style="position: absolute;right:20px;top:30px;">-->
        <!--<div class="layui-btn" onclick="downLoadVideo('{{item.id}}')">下载</div>-->
        <!--<div class="layui-btn layui-btn-danger" onclick="deleteVideo('{{item.id}}')">删除</div>-->
        <!--</div>-->
    </li>
    {{#  }); }}
    {{# if(d.length === 0){ }}
    无数据
    {{# } }}
</script>
<script type="text/html" id="inner">
    <div class='left' style="width: 700px;height:500px;background: #f5f5f5;padding: 20px;margin-top: 40px;display: inline-block">
        <div class='image' style="height: 484px;width: 695px;position: relative;">
            <!--<img src="{{d.cover}}" alt="" style="width: 100%;height: 100%" id="img">-->
            {{#
                if(d.h264Url){
            var url = getAjaxUrl("",d.h264Url);
        }else{
            var url = getAjaxUrl("",d.url);
        }
            }}
            <video src="{{url}}"  style="width: 100%;height: 100%" id="img"></video>
            <div style="width: 60px;height:60px;position:absolute;top:50%;left:50%;margin:-30px 0 0 -30px;">
                <img src="../../common/img/u7603.png" alt="" style="width: 100%;height:100%;">
            </div>
        </div>
    </div>
    <div class="infoBox" style="width: 460px;height:610px;border-left:1px solid #ccc;position: absolute;top:40px;right:0;">
        <form class="layui-form" id='form3' lay-filter="videoInfo">
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">视频名称</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" placeholder="请输入内容" name="name">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">*版权归属</label>
                <div class="layui-input-block" style="width:320px;">
                    <select name="copyright" id="">
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">来源</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" placeholder="请输入内容" name="resc">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">*描述</label>
                <div class="layui-input-block" style="width:320px;">
                    <textarea class="layui-textarea" style="border: 1px solid #ccc" name="fdesc"></textarea>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">文件夹路径</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" placeholder="请输入内容" name="url">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">格式</label>
                <div class="layui-input-block" style="width:320px;">
                    <select name="form" id="">
                        <option value="mp4">MP4</option>
                        <option value="avi">AVI</option>
                        <option value="mov">MOV</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">文件大小</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" name="fsize">
                </div>
            </div>
            <!--<div class="layui-form-item">-->
            <!--<label class="layui-form-label" style="text-align: left;">文件夹路径</label>-->
            <!--<div class="layui-input-block" style="margin-left: 15px;width:380px;">-->
            <!--<input type="text" class="layui-input" value="16:9">-->
            <!--</div>-->
            <!--</div>-->
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">分辨率</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" name="reso">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">版式</label>
                <div class="layui-input-block" style="width:320px;">
                    <select name="style" id="">
                        <option value="0">横版</option>
                        <option value="1">竖版</option>
                        <option value="2">方版</option>
                    </select>
                </div>
            </div>
            <button class="layui-btn layui-btn-normal" style="width: 310px;margin:20px 0 20px 100px;" type="button" lay-submit lay-filter="confirms">确定</button>
        </form>

    </div>
</script>
<script type="text/html" id="tips">
    <div style="text-align: center;margin-top: 40px">已进入转码任务，请在转码管理进行查看</div>
    <div class="layui-btn-container" style="margin: 40px 0px 0  120px">
        <button class="layui-btn " onclick="look()">查看</button>
        <button class="layui-btn  layui-btn-primary" onclick="layer.closeAll()">取消</button>
    </div>
</script>
<script>
    var zNodes;
    var uploadFileBtn;
    var uploadIndex;
    layui.use(['layer', 'element', 'form', 'upload'], function () {
        var layer = layui.layer,
            element = layui.element,
            form = layui.form,
            upload = layui.upload;
        //创建监听函数
        var xhrOnProgress = function (fun) {
            xhrOnProgress.onprogress = fun; //绑定监听
            //使用闭包实现监听绑
            return function () {
                //通过$.ajaxSettings.xhr();获得XMLHttpRequest对象
                var xhr = $.ajaxSettings.xhr();
                //判断监听函数是否为函数
                if (typeof xhrOnProgress.onprogress !== 'function')
                    return xhr;
                //如果有监听函数并且xhr对象支持绑定时就把监听函数绑定上去
                if (xhrOnProgress.onprogress && xhr.upload) {
                    xhr.upload.onprogress = xhrOnProgress.onprogress;
                }
                return xhr;
            }
        }
        var form = "mp4|avi|mpg";
        var form1;
        if (localStorage.getItem("videosupForm")) {
            form1 = localStorage.getItem("videosupForm").split(",").join("|") + "|" + form;
        }

        var supForm = form1 || form
        var size = "1024*0"
        var size1 = localStorage.getItem("upsize");
        var supSize = size1 || size;
        uploadFileBtn = upload.render({
            elem: '#chooseFile', //绑定元素
            url: getAjaxUrl(service_prefix.resources,'/picture/videoupload?id=' + columnId), //上传接口
            exts: supForm,//限定上传类型
            accept: 'video',//指定允许上传时校验的文件类型 images（图片）、file（所有文件）、video（视频）、audio（音频）
            xhr: xhrOnProgress,
            multiple: true,// 开启多文件上传
            drag: true, //是否允许拖拽上传
            size: supSize,//为0为不限制大小
            progress: function (value) { //上传进度回调 value进度值
                element.progress('upload_progress', value + '%') //设置页面进度条
            },
            before: function (obj) {
                uploadIndex = layer.load();
                //开始上传时候让进度条去除隐藏状态
                $("#upload_progress").removeClass("layui-hide");
            },
            done: function (res, index, upload) {//在多文件上传中 每次成功将被调用一次
                if (res.success) {//此处只用于单文件图片的上传，若为多图片多文件请做其他处理
                    var video = res.obj;
                    imgArr.push(video)
                    localStorage.setItem('uploadImg', JSON.stringify(imgArr));
                    idArr.push(video.id);
                    $("#list2").hide();
                    $("#list3").show();
                    $("#upload_previewpreview").append("<div style='position: relative;width: 230px;height: 146px;margin-left: 20px;float: left;'><video src='" + getAjaxUrl("",video.url) + "'  style='width: 230px;height: 146px;margin-left: 20px;' preload='auto' controls ></video></div>");
                    $("#upload_preview div ").append("<button style='position: absolute;top:5px;right: 5px;background: #000' class='deletePic' class='layui-btn layui-btn-xs'><i class='layui-icon layui-icon-delete' style='color: #FFFFFF'></i></button>")
                    $("#counts").text(imgArr.length)
                    $('.deletePic').each(function () {
                        $(this).click(function () {
                            $(this).prev("video").remove();
                            $(this).remove();
                        })
                    })
                    returnBack6();
                    getVideoList("1",{columnId:columnId});
                }else{
                    layer.close(uploadIndex);
                    layer.alert(res.msg);
                }
            },
            error: function (index, upload) {
                layer.close(uploadIndex);
                //请求异常回调
                layer.close(layer.index);
                layer.confirm("上传失败，您是否要重新上传？", {
                    btn: ['确定', '取消'],
                    icon: 3,
                    title: "提示"
                }, function () {
                    //关闭询问框
                    layer.closeAll();
                    //重新调用上传方法
                    uploadFileBtn.upload();
                })
            }
        });


    })


    function look() {
        layer.closeAll();
        go2Menu('/simple/file/codeManage/code.html', '转码管理')
    }

    var settingss = {
        data: {
            simpleData: {
                enable: true,  //true 、 false 分别表示 使用 、 不使用 简单数据模式
                idKey: "id",  //节点数据中保存唯一标识的属性名称
                pIdKey: "parentId",    //节点数据中保存其父节点唯一标识的属性名称
                rootPId: -1  //用于修正根节点父节点数据，即 pIdKey 指定的属性值
            },
            key: {
                name: "name"  //zTree 节点数据保存节点名称的属性名称  默认值："name"
            }
        },
        view: {showLine: false, showIcon: true},
        callback: {
            onClick: zTreeOnClick1
        }
    };
    var siteObj;
    var columnObj;
    function zTreeOnClick1(event, treeId, treeNode) {

        if (treeNode.level == 1) {
            siteObj = treeNode;
            columnObj = "";
            setSiteId(treeNode.id);
        } else if (treeNode.level >= 2) {
            columnid=treeNode.id;
            columnObj=treeNode;
            var parents = treeNode.getPath();
            /*parents.forEach(res => {
                if (res.level == 1) {
                    setIdParms("", res.id, treeNode.id);
                }
            })*/
            parents.forEach(function (res){
                if(res.level ==1){
                    siteObj=res;
                    setIdParms("", res.id, treeNode.id);
                }
            })
        }
        columnList(1, siteObj.id, columnObj.id);
        // columnList(1, siteId, columnId);

        bool = true;
        if (treeNode.level < 2) {
            $("#uploads").hide();
        } else {
            $("#uploads").show()
        }
        var obj = {
            "pager": {
                "current": 1,
                "size": tempSize
            },
            "picture": {
                "sign": 1
            }
        }
        if (treeNode.level === 0) {
            obj.picture.companyId = treeNode.id;
        } else if (treeNode.level === 1) {
            obj.picture.siteId = treeNode.id;
        } else {
            obj.picture.columnId = treeNode.id;
        }

        ajax(service_prefix.resources, url + "/list", 'post', JSON.stringify(obj)).then(function (res) {
            layui.use('laypage', function () {
                var laypage = layui.laypage;
                //执行一个laypage实例
                laypage.render({
                    elem: 'page1'
                    , count: res.obj.total
                    , curr: res.obj.current
                    , limit: res.obj.size
                    , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                    , jump: function (obj, first) {
                        if (!first) {

                            curr = obj.curr
                            tempSize = obj.limit
                            var obj1 = {};
                            obj1.sign = 1
                            if (columnId) {
                                obj1.columnId = columnId;
                            }else if (siteId) {
                                obj1.companyId = companyId;
                            }else if (companyId) {
                                obj1.siteId = siteId;
                            }
                            getVideoList(curr, obj1);
                        }
                    }
                });
            });
            localStorage.setItem("videoList", JSON.stringify(res.obj.records))
            layui.laytpl($("#videoList").html()).render(res.obj.records, function (html) {
                $("#video").html(html);
                layui.form.render();
            })
            layui.laytpl($("#videoList1").html()).render(res.obj.records, function (html) {
                $("#video1").html(html);
                layui.form.render();
            })
        })
    }

</script>
<script>
    var form = layui.form;
    var forms = "";
    var copyright = "";
    var bool = false;
    var idArr = [];
    layui.form.on("submit(confirms1)", function (data) {
        ajax(service_prefix.resources, url + "/" + ids, "put", JSON.stringify(data.field)).then(function (res) {
            if (res.success) {
                $("#list7").hide();
                $("#list1").show();
                getTreeData()
            }
        })
    })
    var ids = "";

    function zCode() {
        var data = document.getElementsByName("ids")
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择要转码的视频")
            return false;
        }
//        $("#box").show()
//     ajax("/picture/transH264?ids="+ids,'post').then(function (res) {
//         if(res.success){
//            getTreeData()
//  }
//  })
        toH264();

    }

    $("#box li").click(function () {
        var text = $(this).children("span").text();
        if (text === "直接转码") {
            alert(1)
        } else {
            toH264();
        }
        $("#box").hide()
    })

    function toH264(){
        ajax(service_prefix.resources, "/picture/transH264Thread?ids=" + ids, "post").then(function (res) {
            if (res.success) {
                layerOpen("提示", "380", "221", "form11")
                lodTpl("tips", "form11", {})
            }
        })
    }

    $("#box li").hover(function () {
        $(this).addClass("active")
    }, function () {
        $(this).removeClass("active")
    })
    //  $("#box").mouseenter(function () {
    //      $("#box").show()
    //  })
    //  $("#box").mouseleave(function () {
    //      $("#box").hide()
    //  })
    function addMarks() { //批量新建水印
        var data = document.getElementsByName("ids")
        var ids = "";
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择需要加水印的视频")
            return false;
        }
        var markId = localStorage.getItem("markId");
        ajax(service_prefix.resources, "/picture/videoWatermark?ids=" + ids + "&id=" + markId, 'post').then(function (res) {
            if (res.success) {
                getTreeData()
            }
        })


    }

    function createCodes() {
        var data = document.getElementsByName("ids")
        var ids = "";
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择要发布的视频")
            return false;
        }
        var id = localStorage.getItem("videoId");
        if (id && id === ids) {
            layer.alert("该视频已发布过，请重新选择其他视频发布");
            return false
        }
        changeState("发布", ids)
    }

    function deleteVideos() {
        var data = document.getElementsByName("ids")
        var ids = "";
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择要删除的视频")
            return false;
        }
        delVideo(ids)
    }

    function delVideo(ids) { //批量删除视频
        ajax(service_prefix.resources, "/picture/delByIds?ids=" + ids, "get").then(function (res) {
            if (res.success) {
                getTreeData()
            }
        })
    }

    var status, code
    form.on('select(state)', function (data) {
        status = data.value
    })
    form.on('select(code)', function (data) {
        code = Number(data.value)

    })
    form.on("select(forms)", function (data) {
        forms = data.value;
        var obj = {};
        if (data.value === "" || data.value === "全部") {
            getVideoList(1, obj);
        } else {
            obj.form = data.value;
            getVideoList(1, obj);
        }
    })
    form.on("select(copyright)", function (data) {
        copyright = data.value;
        var obj = {};
        if (data.value === "" || data.value === "全部") {
            getVideoList(1, obj);
        }
    })
    form.on("select", function () {
        var obj = {};
        if (forms === "" || forms === "全部") {
            forms = ""
        }
        if (copyright === "" || copyright === "全部") {
            copyright = ""
        }
        obj.form = forms;
        obj.copyright = copyright;
        obj.status = status;
        obj.processing = code;
        getVideoList(1, obj)
    })

    var url = '/picture';
    var url1 = "/video"
    $(function () {
        getTreeData()
    })

    function search() {
        var name = $("#name").val();
        var crUser = $("#crUser").val();
        var obj = {};
        if (!name && !crUser & !startTime & !endTime) {
            getVideoList(1, obj);
        } else {
            obj.name = name;
            obj.crUser = crUser;
            obj.startTime = startTime;
            obj.endTime = endTime;
            getVideoList(1, obj);
        }
    }

    function downLoadVideo(id) {
        window.location.href = service_prefix.resources + "/picture/downLoad?id=" + id;
    }

    function preview(id) {
        $("#list1").hide();
        $("#form9").show()
        localStorage.setItem("id2", id)
        ajax(service_prefix.resources, url + "/viewCompress?ids=" + id, 'post').then(function (res) {
            if (res.success) {
                console.log(res);
            }
        })
        ajax(service_prefix.resources, url + "/getVideoinfo?ids=" + id, "post").then(function (res) {
            if (res.success) {
                if (res.obj[0].length == 0) {
                    $("#heads1").hide();
                    return;
                }
                $("#detai1").val(res.obj[0][0])
                $("#detai2").val(res.obj[0][1])
                $("#detai3").val(res.obj[0][2])
                $("#detai4").val(res.obj[0][3])
            }
        })
        ajax(service_prefix.resources, url + "/" + id, 'get').then(function (res) {
            layui.laytpl($("#detail").html()).render(res.obj, function (html) {
                $("#form9").html(html);
                layui.form.render();
                var picInfo = localStorage.getItem('picInfo1');
                if (picInfo === "是") {
                    $("#heads1").show()
                } else {
                    $("#heads1").hide()
                }
                var video = document.getElementById('videos1');
                video.addEventListener("timeupdate", function () {
                    localStorage.setItem("time", video.currentTime)
                }, false)


                $("#selection").show()

                layui.form.on("radio(qx)", function (data) {
                    ajax(service_prefix.resources, url + "/" + id, 'get').then(function (t) {
                        var obj = {};

                        obj.resoType = Number(data.value);
                        obj.resParentId = t.obj.id;
                        var jsonData = {
                            "pager": {
                                "current": 1,
                                "size": 10
                            },
                            "picture": obj
                        }
                        ajax(service_prefix.resources, url + "/list", 'post', JSON.stringify(jsonData)).then(function (s) {
                            if (s.success) {
                                if (s.obj.records.length === 0) {
                                    layer.alert("你所选的清晰度高于原视频清晰度，请重新选择清晰度")
                                    return false;
                                }

                                $('video').attr('src', getAjaxUrl("",s.obj.records[0].url));


                            }
                        })
                    })
//              }
                })
//          $("#selection").show()
            })
            layui.use('element', function () {
                var $ = layui.jquery
                    , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

                //触发事件
                var active = {
                    tabAdd: function () {
                        //新增一个Tab项
                        element.tabAdd('demo', {
                            title: '新选项' + (Math.random() * 1000 | 0) //用于演示
                            , content: '内容' + (Math.random() * 1000 | 0)
                            , id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
                        })
                    }
                    , tabDelete: function (othis) {
                        //删除指定Tab项
                        element.tabDelete('demo', '44'); //删除：“商品管理”


                        othis.addClass('layui-btn-disabled');
                    }
                    , tabChange: function () {
                        //切换到指定Tab项
                        element.tabChange('demo', '22'); //切换到：用户管理
                    }
                };

                $('.site-demo-active').on('click', function () {
                    var othis = $(this), type = othis.data('type');
                    active[type] ? active[type].call(this, othis) : '';
                });

                //Hash地址的定位
                var layid = location.hash.replace(/^#test=/, '');
                element.tabChange('test', layid);

                element.on('tab(test)', function (elem) {
                    location.hash = 'test=' + $(this).attr('lay-id');
                });

            });


//                $('#play').click(function(){ //这个视频被点击后执行
//                    var img = $(this).attr('vpath');//获取视频预览图
//                    var video = $(this).attr('ipath');//获取视频路径
//                    $('.videos').html("<video id=\"video\"  ' style='width: 600px;height:450px;' src='"+video+"' preload=\"auto\" controlsList=\"nodownload\" controls=\"controls\" autoplay=\"autoplay\"></video>");
//                    $('.videos').show();
//                });
        })


    }

    var videos = JSON.parse(localStorage.getItem("videoList"))
    var srcArr = []
    var ids1 = []
    var indexs = 0
    for (var i in videos) {
        srcArr.push(videos[i].url)
        ids1.push(videos[i].id)
    }
    var id1 = localStorage.getItem("id2")
    for (var i in ids1) {
        if (id1 === ids1[i]) {
            indexs = i;
        }
    }
    function next() {
        indexs++;
        if (indexs > srcArr.length - 1) {
            layer.alert("已经到了最后一个视频了");
            return;
        }
        ajax(service_prefix.resources, url + "/" + ids1[indexs], 'get').then(function (res) {
            layui.laytpl($("#detail").html()).render(res.obj, function (html) {
                $("#form9").html(html);
                layui.form.render();
                var picInfo = localStorage.getItem('picInfo1');
                if (picInfo === "是") {
                    $("#heads1").show()
                } else {
                    $("#heads1").hide()
                }
                var video = document.getElementById('videos1');
                video.addEventListener("timeupdate", function () {
                    localStorage.setItem("time", video.currentTime)

                }, false)


                $("#selection").show()

                layui.form.on("radio(qx)", function (data) {
                    ajax(service_prefix.resources, url + "/" + id, 'get').then(function (t) {
                        var obj = {};

                        obj.resoType = Number(data.value);
                        obj.resParentId = t.obj.id;
                        var jsonData = {
                            "pager": {
                                "current": 1,
                                "size": 10
                            },
                            "picture": obj
                        }
                        ajax(service_prefix.resources, url + "/list", 'post', JSON.stringify(jsonData)).then(function (s) {
                            if (s.success) {
                                if (s.obj.records.length === 0) {
                                    layer.alert("你所选的清晰度高于原视频清晰度，请重新选择清晰度")
                                    return false;
                                }

                                $('video').attr('src', s.obj.records[0].url);


                            }
                        })
                    })
//              }
                })
//          $("#selection").show()
            })
            layui.use('element', function () {
                var $ = layui.jquery
                    , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

                //触发事件
                var active = {
                    tabAdd: function () {
                        //新增一个Tab项
                        element.tabAdd('demo', {
                            title: '新选项' + (Math.random() * 1000 | 0) //用于演示
                            , content: '内容' + (Math.random() * 1000 | 0)
                            , id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
                        })
                    }
                    , tabDelete: function (othis) {
                        //删除指定Tab项
                        element.tabDelete('demo', '44'); //删除：“商品管理”


                        othis.addClass('layui-btn-disabled');
                    }
                    , tabChange: function () {
                        //切换到指定Tab项
                        element.tabChange('demo', '22'); //切换到：用户管理
                    }
                };

                $('.site-demo-active').on('click', function () {
                    var othis = $(this), type = othis.data('type');
                    active[type] ? active[type].call(this, othis) : '';
                });

                //Hash地址的定位
                var layid = location.hash.replace(/^#test=/, '');
                element.tabChange('test', layid);

                element.on('tab(test)', function (elem) {
                    location.hash = 'test=' + $(this).attr('lay-id');
                });

            });


//                $('#play').click(function(){ //这个视频被点击后执行
//                    var img = $(this).attr('vpath');//获取视频预览图
//                    var video = $(this).attr('ipath');//获取视频路径
//                    $('.videos').html("<video id=\"video\"  ' style='width: 600px;height:450px;' src='"+video+"' preload=\"auto\" controlsList=\"nodownload\" controls=\"controls\" autoplay=\"autoplay\"></video>");
//                    $('.videos').show();
//                });
        })
    }

    function prev1() {
        indexs--;
        if (indexs < 0) {
            layer.alert("已经到了第一个视频了");
            return;
        }
        ajax(service_prefix.resources, url + "/" + ids1[indexs], 'get').then(function (res) {
            layui.laytpl($("#detail").html()).render(res.obj, function (html) {
                $("#form9").html(html);
                layui.form.render();
                var picInfo = localStorage.getItem('picInfo1');
                if (picInfo === "是") {
                    $("#heads1").show()
                } else {
                    $("#heads1").hide()
                }
                var video = document.getElementById('videos1');
                video.addEventListener("timeupdate", function () {
                    localStorage.setItem("time", video.currentTime)

                }, false)


                $("#selection").show()

                layui.form.on("radio(qx)", function (data) {
                    ajax(service_prefix.resources, url + "/" + id, 'get').then(function (t) {
                        var obj = {};

                        obj.resoType = Number(data.value);
                        obj.resParentId = t.obj.id;
                        var jsonData = {
                            "pager": {
                                "current": 1,
                                "size": 10
                            },
                            "picture": obj
                        }
                        ajax(service_prefix.resources, url + "/list", 'post', JSON.stringify(jsonData)).then(function (s) {
                            if (s.success) {
                                if (s.obj.records.length === 0) {
                                    layer.alert("你所选的清晰度高于原视频清晰度，请重新选择清晰度")
                                    return false;
                                }

                                $('video').attr('src', getAjaxUrl("",s.obj.records[0].url));


                            }
                        })
                    })
//              }
                })
//          $("#selection").show()
            })
            layui.use('element', function () {
                var $ = layui.jquery
                    , element = layui.element; //Tab的切换功能，切换事件监听等，需要依赖element模块

                //触发事件
                var active = {
                    tabAdd: function () {
                        //新增一个Tab项
                        element.tabAdd('demo', {
                            title: '新选项' + (Math.random() * 1000 | 0) //用于演示
                            , content: '内容' + (Math.random() * 1000 | 0)
                            , id: new Date().getTime() //实际使用一般是规定好的id，这里以时间戳模拟下
                        })
                    }
                    , tabDelete: function (othis) {
                        //删除指定Tab项
                        element.tabDelete('demo', '44'); //删除：“商品管理”


                        othis.addClass('layui-btn-disabled');
                    }
                    , tabChange: function () {
                        //切换到指定Tab项
                        element.tabChange('demo', '22'); //切换到：用户管理
                    }
                };

                $('.site-demo-active').on('click', function () {
                    var othis = $(this), type = othis.data('type');
                    active[type] ? active[type].call(this, othis) : '';
                });

                //Hash地址的定位
                var layid = location.hash.replace(/^#test=/, '');
                element.tabChange('test', layid);

                element.on('tab(test)', function (elem) {
                    location.hash = 'test=' + $(this).attr('lay-id');
                });

            });


//                $('#play').click(function(){ //这个视频被点击后执行
//                    var img = $(this).attr('vpath');//获取视频预览图
//                    var video = $(this).attr('ipath');//获取视频路径
//                    $('.videos').html("<video id=\"video\"  ' style='width: 600px;height:450px;' src='"+video+"' preload=\"auto\" controlsList=\"nodownload\" controls=\"controls\" autoplay=\"autoplay\"></video>");
//                    $('.videos').show();
//                });
        })
    }

    function deleteVideo(id) {
//            alert(id);

        layer.open({
            type: 1 //此处以iframe举例
            , title: '提示'
            , area: ['380px', '221px']
            , shade: 0.3
            , maxmin: true
            , content: "<div style='text-align:center;line-height:120px;'>确认要删除此视频及其信息吗？</div>"
            , btn: ['确定', '取消'] //只是为了演示
            , btn2: function () {
                layer.closeAll();
            },
            yes: function () {
                ajax(service_prefix.resources, url + "/delByIds?ids=" + id, 'get').then(function (res) {
                    if (res.success) {
                        layer.closeAll();
                        getTreeData()
                    }
                })
            }

        });
    }

    var tempSize = 15;

    function getVideoList(curr, obj) {
        obj.sign = 1;
        var jsonData = {
            "pager": {
                "current": curr,
                "size": tempSize
                , "sortProps": [
                    {
                        "key": "datetime",
                        "value": false
                    }
                ]
            },
            "picture": obj
        }
        ajax(service_prefix.resources, url + "/list", 'post', JSON.stringify(jsonData)).then(function (res) {
            localStorage.setItem("videoList", res.obj.records)
            layui.use('laypage', function () {
                var laypage = layui.laypage;

                //执行一个laypage实例
                laypage.render({
                    elem: 'test1'
                    , count: res.obj.total
                    , curr: res.obj.current
                    , limit: res.obj.size
                    , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                    , jump: function (obj, first) {
                        if (!first) {
                            curr = obj.curr
                            tempSize = obj.limit
                            var obj1 = {};
                            obj1.sign = 1
                            getVideoList(curr, obj1);
                        }
                    }
                });
            });
            layui.laytpl($("#videoList").html()).render(res.obj.records, function (html) {
                $("#video").html(html);
                layui.form.render();
            })
            layui.laytpl($("#videoList1").html()).render(res.obj.records, function (html) {
                $("#video1").html(html);
                layui.form.render();
            })
        })
    }
</script>
<script>
    var imgArr = [];
    var startTime = '', endTime = ""
    layui.use('laydate', function () {  //日期显示组件
        var laydate = layui.laydate;
        laydate.render({
            elem: '#t12'
            , range: true
            , done: function (value) {
                startTime = value.split(' -')[0]
                endTime = value.split('- ')[1]
            }
        });

    })

    function editVideo() {

        var id = idArr.join(",");
        ids = id;
        ajax(service_prefix.resources, url + "/" + id, "get").then(function (res) {
            if (res.success) {
                layer.closeAll();
                $('#list3').hide();
                $('#list5').show()
                $("#mov").attr("src", res.obj.url)
                layui.form.val('videoInfo', res.obj)
            }
        })
    }

    function setting() {
        layer.open({
            type: 1 //此处以iframe举例
            , title: '设置'
            , area: ['520px', '640px']
            , shade: 0.3
            , maxmin: true
            , content: "<div id='form1'></div>"

        });
        var data = {
            "pager": {
                "current": 1,
                'size': 10
            },
            "entity": {
                "wmkSign": "1"
            }
        }
        layui.laytpl($("#setForms").html()).render({}, function (html) {
            $("#form1").html(html)
            ajax(service_prefix.resources, "/manage/watermark/1190170214461882370", "get").then(function (res) {
                if (res.success) {
                    $("#supForm").val(res.obj.supForm)
                }
            })
            ajax(service_prefix.resources, '/manage/watermark/list', 'post', JSON.stringify(data)).then(function (res) {
                if (res.success) {
                    var records = res.obj.records;

                    var marks;
                    for (var i in records) {
                        marks += '<option value="' + records[i].id + '">' + records[i].name + '</option>'

                    }
                    $("#marks").append(marks)

                    layui.form.render();
                }
            })

            var obj = {}
            obj.isCompress = 2;
            var data2 = {
                'entity': obj,
                "pager": {
                    "current": 1,
                    'size': 10
                }
            }
            ajax(service_prefix.resources, '/manage/watermark/list', 'post', JSON.stringify(data2)).then(function (res) {
                if (res.success) {
                    var records = res.obj.records;

                    var marks = '';
                    for (var i in records) {
                        marks += '<option value="' + records[i].id + '">' + records[i].copyRight + '</option>'

                    }
                    $("#copyrights").append(marks)

                    layui.form.render();
                }
            })
            layui.form.render();
        })
        layui.form.verify({
            videoForms: [
                /^(mp4|VOB|swf|avi|flv|mpg|rm|mov|wav|asf|3gp|mkv|rmvb)|((.*)(mp4|VOB|swf|avi|flv|mpg|rm|mov|wav|asf|3gp|mkv|rmvb)(.*)(,mp4|,VOB|,swf|,avi|,flv|,mpg|,rm|,mov|,wav|,asf|,3gp|,mkv|,rmvb))$/,
                '视频格式有误，请输入正确的格式'
            ]
        });
        layui.form.on('radio(Zcode)', function (data) {
            localStorage.setItem("Zcode", data.value);
        })
    }

    function add() {
        $('#list4').hide();
        $('#list5').show();
    }

    function upload() {
        layer.open({
            type: 1 //此处以iframe举例
            , title: '上传'
            , area: ['800px', '600px']
            , shade: 0.3
            , maxmin: false
            , content: "<div id='form9'></div>"

        });
        layui.laytpl($("#uploadTpl").html()).render({}, function (html) {
            $("#form9").html(html);
            layui.form.render();
        })

    }


    function returnBack() {
        $("#list1").show();
        $('#list2').hide();
    }

    function returnBack1() {
        $("#list2").show();
        $('#list3').hide();
    }

    function returnBack2() {
        $("#list3").show();
        $('#list4').hide();
    }

    function returnBack3() {
        $("#list4").show();
        $('#list5').hide();
    }

    function returnBack4() {
        $("#list1").show();
        $('#list6').hide();
    }

    function returnBack5() {
        $("#list1").show();
        $('#list7').hide();
    }

    function returnBack6() {
        $("#list1").show();
        $('#form9').hide();
        $("#videos1").attr("src","");
    }

    $("#change2").hover(function () {
        $(this).attr('src', '../../common/img/u6611_mouseOver.png');
    }, function () {
        $(this).attr('src', '../../common/img/u6611.png');
    })

    var idArr = [];
    $('.img1').click(function () {
        if ($(this).find('img').attr('id') == 'change2') {
            $(this).find('img').attr('src', '../../common/img/u6611_mouseOver.png');
            $('#change1').attr('src', '../../common/img/u6616.png')
            $(".imgBox").hide()
            $(".imgBox1").show()
        } else if ($(this).find('img').attr('id') == 'change1') {
            $(this).find('img').attr('src', '../../common/img/u6616_mouseOver.png');
            $('#change2').attr('src', '../../common/img/u6611.png')
            $(".imgBox").show()
            $(".imgBox1").hide()
        }
    })


    layui.use('form', function () { //声明使用layUI的form
        var form = layui.form;
        form.render(); //刷新所有渲染效果，也可以单独熟悉某个效果
        //监听提交
        form.on('submit(formDemo)', function (data) {
            layer.msg(JSON.stringify(data.field));
            return false;
        });
    });
    layui.use('layer', function () { //独立版的layer无需执行这一句
        var layer = layui.layer; //独立版的layer无需执行这一句
        //触发事件
        var active = {
            preview: function () {
                layer.msg("<div id='form9'></div>", {
                    time: 0,
                    closeBtn: 2,
                    shade: 0.3,
                    area: ['1300px', '530px']
                });
                layui.laytpl($("#detail").html()).render({}, function (html) {
                    $("#form9").html(html);
                    layui.form.render();
                })
                $('#play').click(function () { //这个视频被点击后执行
                    var img = $(this).attr('vpath');//获取视频预览图
                    var video = $(this).attr('ipath');//获取视频路径
                    $('.videos').html("<video id=\"video\" poster='" + img + "' style='width: 795px;height:464px;' src='" + video + "' preload=\"auto\" controlsList=\"nodownload\" controls=\"controls\" autoplay=\"autoplay\"></video><img onClick=\"close1()\" class=\"vclose\" src=\"gb.png\" width=\"25\" height=\"25\"/>");
                    $('.videos').show();
                });

                function close1() {
                    var v = document.getElementById('video');//获取视频节点
                    $('.videos').hide();//点击关闭按钮关闭暂停视频
                    v.pause();
                    $('.videos').html();
                }
            },
            delete: function () {
                var that = this;
                //多窗口模式，层叠置顶

            },
            upload: function () {
                if (!bool) {
                    var that = this;
                    //多窗口模式，层叠置顶
                    layer.open({
                        type: 1 //此处以iframe举例
                        , title: '上传到'
                        , area: ['502px', '470px']
                        , shade: 0.3
                        , maxmin: true
                        , content: "<div id='form'></div>"
                        , btn: ['开始上传', '取消'] //只是为了演示
                        , btn2: function () {
                            layer.closeAll();
                        }
                        , yes: function () {
                            if (!columnId) {
                                layer.alert("请先选择栏目");
                                return;
                            }
                            layer.closeAll();
                            $("#list1").hide();
                            $('#list2').show();
                        }

                    });
                    layui.laytpl($("#upload").html()).render({}, function (html) {
                        $("#form").html(html);
                        layui.form.render();
                    })
                    var settingss = {
                        data: {
                            simpleData: {
                                enable: true,  //true 、 false 分别表示 使用 、 不使用 简单数据模式
                                idKey: "id",  //节点数据中保存唯一标识的属性名称
                                pIdKey: "parentId",    //节点数据中保存其父节点唯一标识的属性名称
                                rootPId: -1  //用于修正根节点父节点数据，即 pIdKey 指定的属性值
                            },
                            key: {
                                name: "name"  //zTree 节点数据保存节点名称的属性名称  默认值："name"
                            }
                        },
                        view: {showLine: false, showIcon: true},
                        callback: {
                            onClick: zTreeOnClick
                        }
                    };
                    ajax(service_prefix.manage, "/programa/getTreeData", "post", {}).then(data => {
                        var nodes = data.obj;
                        global.zTreeObj = $.fn.zTree.init($("#treeDemo1"), settingss, data.obj); //初始化树
                        global.zTreeObj.expandAll(true);    //true 节点全部展开、false节点收缩
                    })
                } else {
                    $("#list1").hide();
                    $('#list2').show();
                    uploadFileBtn.reload({
                        url: getAjaxUrl(service_prefix.resources, '/picture/videoupload?id=' + columnId), //上传接口
                    })
                }
            }
        };

        function uploadVideo() {

        }

        function zTreeOnClick(event, treeId, treeNode) {
            if (treeNode.level > 1) {
                columnId = treeNode.id;
            }
            var idArr = [];
            uploadFileBtn.reload({
                url: getAjaxUrl(service_prefix.resources, '/picture/videoupload?id=' + columnId), //上传接口
            })
        }

        $('.layui-btn').click(function (event) {
            event.stopPropagation();
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
        $('#preview').click(function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
    });
    form.on('radio(picInfo)', function (data) {

        localStorage.setItem("picInfo1", data.value)
    });
    form.on('checkbox(check)', function (data) {
        var checked = data.elem.checked;
        var idArr = JSON.parse(localStorage.getItem('idArr1'))
        var zCode = localStorage.getItem("Zcode");
        if (checked) {
            var id = idArr.join(",");
            var markId = localStorage.getItem("markId");
            if (zCode === "否" || !zCode) {
                ajax(service_prefix.resources, "/picture/videoWatermark?ids=" + id + "&id=" + markId, 'post').then(function (res) {
                    if (res.success) {
                        console.log(res)
                    }
                })
            } else {
                ajax(service_prefix.resources, "/picture/transH264?ids=" + ids, 'post').then(function (res) {
                    if (res.success) {
                        ajax(service_prefix.resources, "/picture/videoWatermark?ids=" + id + "&id=" + markId, 'post').then(function (data) {
                            if (data.success) {
                                console.log(data)
                            }
                        })
                    }
                })
            }
        }
    })
</script>
<script type="text/html" id="setForms">
    <form class="layui-form" style="margin-top: 10px;">
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">屏幕大小：</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <select name="compress" id="">
                    <option value="16:9" selected>16:9</option>
                    <option value="4:3">4:3</option>
                    <option value="3:2">3:2</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">宽高比：</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <input type="text" class="layui-input" autocomplete="off" name="fsize">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:105px;text-align: left;margin-left: 24px">默认MP4转码：</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <input type="radio" name="sex" value="是" title="是" lay-filter="Zcode">
                <input type="radio" name="sex" value="否" title="否" lay-filter="Zcode" checked>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:105px;text-align: left;margin-left: 24px">视频信息抽取:</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <input type="radio" name="sex" value="是" title="是" lay-filter="picInfo">
                <input type="radio" name="sex" value="否" title="否" lay-filter="picInfo" checked>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">支持格式</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <input type="text" class="layui-input" autocomplete="off" name="supForm" id="supForm" value="mp4,avi,mpg,VOB" lay-verify="videoForms">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">大小限制</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <select name="upsize" id="upsize">
                    <option value="10240" selected>10M</option>
                    <option value="102400">100M</option>
                    <option value="512000">500M</option>
                    <option value="1024000">1000M</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">所属版权</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <select name="copyRight" id="copyrights">

                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">汇总子栏目</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <input type="radio" name="sex" value="是" title="是">
                <input type="radio" name="sex" value="否" title="否">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 15px;width:95px;text-align: left;margin-left: 24px">水印</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 5px;float: left;">
                <select name="waterMark" id="marks" lay-filter="selected">
                </select>
            </div>
        </div>

        <div class="layui-btn-container" style="margin: 35px 170px;">
            <button class="layui-btn" type="button" lay-submit lay-filter="saveWaterMark">确定</button>
            <button class="layui-btn layui-btn-primary" onclick="layer.closeAll()" type="button">取消</button>
        </div>
    </form>
</script>
<script type="text/html" id='upload'>
    <div class='treeBox' style='margin:15px 35px;border:1px solid #f5f5f5;width:428px;height:317px;'>
        <ul id="treeDemo1" class="ztree" style="width: 428px;height: 317px;"></ul>
    </div>
</script>
<script type="text/html" id='detail'>
    <div class='prev1' style="position: absolute;top: 290px;left: 20px">
        <button class="layui-btn layui-btn-sm" title="上一个视频" onclick="prev1()" id="prev"><i class='layui-icon layui-icon-left'></i></button>
    </div>
    <div class='next1' style="position: absolute;top: 290px;left: 700px">
        <button class="layui-btn layui-btn-sm" title="下一个视频" onclick="next()"><i class='layui-icon layui-icon-right'></i></button>
    </div>
    <div class='box'>
        <div class='left' style="height: 500px;position: relative">
            <div id="play" style='position:relative;height: 450px;'>
                <video style='width: 600px;height:450px;' controls id="videos1" autoplay>
                    {{#
                        if(d.h264Url){
                    var url = getAjaxUrl("",d.h264Url);
                }else{
                    var url = getAjaxUrl("",d.url);
                }
                    }}
                    <source src="{{url}}" type="video/mp4">
                </video>

            </div>

            <!--<div style="margin-top: 10px;" id="selection">
                <p style="display: inline-block;color: #000;font-size: 20px;float: left;line-height: 48px">清晰度选择：</p>
                <div class="layui-btn-container" style="display: inline-block;width: 320px;float: left">
                    &lt;!&ndash;<button class="layui-btn layui-btn-normal">360</button>&ndash;&gt;
                    &lt;!&ndash;<button class="layui-btn layui-btn-normal">480</button>&ndash;&gt;
                    &lt;!&ndash;<button class="layui-btn layui-btn-normal">720</button>&ndash;&gt;
                    &lt;!&ndash;<button class="layui-btn layui-btn-normal">1080</button>&ndash;&gt;
                    <form class="layui-form">
                        <div class="layui-form-item">
                            <div class="layui-input-block" style="margin-left: 10px;width: 400px">
                                <input type="radio" name="sex" value="360" title="360p" lay-filter="qx">
                                <input type="radio" name="sex" value="480" title="480p" lay-filter="qx">
                                <input type="radio" name="sex" value="720" title="720p" lay-filter="qx">
                                <input type="radio" name="sex" value="1080" title="1080p" lay-filter="qx">
                            </div>
                        </div>
                    </form>
                </div>
            </div>-->
        </div>
        <div class='rights' style="overflow: hidden">
            <button class="layui-btn" style="position: absolute;right:20px;top:20px" onclick="returnBack6()">返回</button>
            <div class="layui-tab">
                <ul class="layui-tab-title">
                    <li class="layui-this">基本信息</li>
                    <li id="heads1" style="display: none">详细信息</li>

                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">
                        <div class='layui-btn-container' style='margin-top:50px;'>

                            <button class="layui-btn layui-btn-sm layui-btn-normal "
                            >{{#if(d.collection===0){ }}
                                <img src="../../../common/img/u582.png" alt="" onclick="collect('{{d.id}}',event)" style="    width: 25px;
    height: 25px;
    margin-top: 3px;">
                                {{#} else if(d.collection===1){ }}
                                <img src="../../../common/img/u582_mouseOver.png" alt="" onclick="collect('{{d.id}}',event)" style="    width: 25px;
    height: 25px;
    margin-top: 3px;">
                                {{#} }}
                            </button>

                            <!--                            <button class='layui-btn layui-btn-normal layui-btn-sm' onclick="getTimes('{{d.id}}')">按帧截取</button>-->
                            <!--                            <button class='layui-btn layui-btn-normal layui-btn-sm  layui-btn-disabled' disabled onclick="setCover('{{d.id}}')" id="cover">设为封面</button>-->
                            <button class='layui-btn layui-btn-normal layui-btn-sm' onclick="downLoadVideo('{{d.id}}')">立即下载</button>
                            <!--                            <span class="imgIcon">-->
                            <!--           <img src="" alt="" id="icon" style="width: 100%;height: 100%;">-->
                            <!--        </span>-->
                        </div>
                        <p style='margin-top:20px; color:#666;text-align:left;'>名称：{{d.name}}</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>大小：{{d.fsize}}KB</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>格式：{{d.form}}</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>上传时间：2019.04.26</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>路径：{{d.url}}</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>来源：{{d.resc}}</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>版权所属：{{d.copyright}}</p>
                        <p style='margin-top:10px; color:#666;text-align:left'>创建者：{{d.crUser}}</p>
                        {{#if(d.status===0){ }}
                        <p style='margin-top:10px; color:#666;text-align:left'>视频状态：新稿</p>
                        {{#} else if(d.status===10){ }}
                        <p style='margin-top:10px; color:#666;text-align:left'>视频状态：审核</p>
                        {{#} else if(d.status===20){ }}
                        <p style='margin-top:10px; color:#666;text-align:left'>视频状态：发布</p>
                        {{#} }}
                        <div class="layui-btn-container" style="margin-top: 20px;">
                            {{#if(d.status!=10){ }}
                            <button class='layui-btn' onclick="changeState('审核','{{d.id}}')">审核</button>
                            {{#} }}
                            {{#if(d.status!=20){ }}
                            <button class='layui-btn' onclick="changeState('发布','{{d.id}}')">发布
                                {{#} }}
                                <button class='layui-btn layui-btn-danger' onclick="updateVideo('{{d.id}}')">修改</button>
                        </div>
                    </div>
                    <div class="layui-tab-item">
                        <div class='layui-btn-container' style='margin-top:50px;'>

                            <button class="layui-btn layui-btn-sm layui-btn-normal "
                            >{{#if(d.collection===0){ }}
                                <img src="../../../common/img/u582.png" alt="" onclick="collect('{{d.id}}',event)" style="    width: 25px;
    height: 25px;
    margin-top: 3px;">
                                {{#} else if(d.collection===1){ }}
                                <img src="../../../common/img/u582_mouseOver.png" alt="" onclick="collect('{{d.id}}',event)" style="    width: 25px;
    height: 25px;
    margin-top: 3px;">
                                {{#} }}
                            </button>

                            <!--                            <button class='layui-btn layui-btn-normal layui-btn-sm' onclick="getTimes('{{d.id}}')">按帧截取</button>-->
                            <!--                            <button class='layui-btn layui-btn-normal layui-btn-sm' onclick="setCover('{{d.id}}')">设为封面</button>-->
                            <button class='layui-btn layui-btn-normal layui-btn-sm' onclick="downLoadVideo('{{d.id}}')">立即下载</button>
                            <!--                            <span class="imgIcon">-->
                            <!--           <img src="" alt="" id="icon" style="width: 100%;height: 100%;">-->
                            <!--        </span>-->
                        </div>
                        <form class="layui-form" style="height: 614px;margin-top: 20px" lay-filter="detailInfo">
                            <div class="layui-form-item">
                                <label class="layui-form-label" style="width: 100px;padding: 9px 0">比特率</label>
                                <div class="layui-input-block">
                                    <input type="text" class="layui-input" id="detai1" disabled style="border: none">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style="width: 100px;padding: 9px 0">采样率</label>
                                <div class="layui-input-block">
                                    <input type="text" class="layui-input" id="detai2" disabled style="border: none">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style="width: 100px;padding: 9px 0">声道树</label>
                                <div class="layui-input-block">
                                    <input type="text" class="layui-input" id="detai3" disabled style="border:none">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label" style="width: 100px;padding: 9px 0">编码格式</label>
                                <div class="layui-input-block">
                                    <input type="text" class="layui-input" id="detai4" disabled style="border: none">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!--<div class='next'>-->
    <!--<i class='layui-icon layui-icon-right'></i>-->
    <!--</div>-->
</script>
<script>
    var ids = "";

    function updateVideo(id) {
        ajax(service_prefix.resources, url + "/" + id, "get").then(function (res) {
            if (res.success) {
                $("#form9").hide();
                $("#videos1").attr("src","");
                $("#list7").show();
                layui.laytpl($("#inner").html()).render(res.obj, function (html) {
                    $("#inner5").html(html);
                    layui.form.val('videoInfo', res.obj)
                    ids = id;
                })
            }
        })
    }

    layui.form.on("submit(confirms)", function (data) {
        var data2=$('keyword').select2('val');
        if (data2){
            data.field.keyword=data2.join(";");
        }
        ajax(service_prefix.resources, url + "/" + ids, "put", JSON.stringify(data.field)).then(function (res) {
            if (res.success) {
                $("#list7").hide();
                $("#list1").show();
                getTreeData()
            }
        })
        return false;
    })

    function collect(id, event) {
        var src = event.target.getAttribute('src')
        if (src === "../../../common/img/u582.png") {
            event.target.setAttribute('src', "../../../common/img/u582_mouseOver.png")
            ajax(service_prefix.resources, url + "/changeCollect?id=" + id, 'post').then(function (res) {
                console.log(res)
            })
        } else if (src === "../../../common/img/u582_mouseOver.png") {
            event.target.setAttribute('src', "../../../common/img/u582.png")
            ajax(service_prefix.resources, url + "/changeCollect?id=" + id, 'post').then(function (res) {
                console.log(res)
            })
        }
    }

    function setCover(id) { //设置封面
        ajax(service_prefix.resources, url + "/" + id, 'get').then(function (res) {
            if (res.success) {
//             $(".cover").attr("src",res.obj.cutPicUrl)

                var obj = {};
                obj.cover = res.obj.cutPicUrl;
                ajax(service_prefix.resources, url + "/" + id, "put", JSON.stringify(obj)).then(function (res) {
                    if (res.success) {
                        $("#list1").show();
                        $("#form9").hide()
                        $("#videos1").attr("src","");
                        getTreeData()
                    }
                })
            }
        })
    }

    function getTimes(id) {
        var video = document.getElementById('videos1');
        var time = Math.floor(localStorage.getItem('time')) * 1000;
        ajax(service_prefix.resources, "/picture/cutPicture?id=" + id + "&time=" + getForm(time), "post").then(function (res) {
            if (res.success) {
                $("#icon").attr("src", getAjaxUrl("",res.msg))
                $("#cover").removeClass(" layui-btn-disabled")
                $("#cover").removeAttr("disabled")
            }
        })

    }

    function getForm(msd) {
        var time = parseFloat(msd) / 1000;
        if (null != time && "" != time) {
            if (time > 60 && time < 60 * 60) {
                var a = parseInt(time / 60.0) < 10 ? ('0' + parseInt(time / 60.0)) : parseInt(time / 60.0);
                var ms = parseInt((parseFloat(time / 60.0) - parseInt(time / 60.0)) * 60);
                var b = (ms < 10) ? ('0' + ms) : ms;
                time = '00:' + a + ':' + b;
            } else if (time >= 60 * 60 && time < 60 * 60 * 24) {
                var H = parseInt(time / 3600.0) < 10 ? ('0' + parseInt(time / 3600.0)) : parseInt(time / 3600.0);
                var ms = parseInt((parseFloat(time / 3600.0) - parseInt(time / 3600.0)) * 60);
                var M = (ms < 10) ? ('0' + ms) : ms;
                var ss = parseInt((parseFloat((parseFloat(time / 3600.0) - parseInt(time / 3600.0)) * 60) -
                    parseInt((parseFloat(time / 3600.0) - parseInt(time / 3600.0)) * 60)) * 60);
                var S = (ss < 10) ? ('0' + ss) : ss;
                time = H + ':' + M + ':' + S;
            } else {
                var d = parseInt(time) < 10 ? ('0' + parseInt(time)) : parseInt(time);
                time = '00:00:' + d;
            }
        }
        return time;

    }

    function changeState(status, id) {
        if (status === "审核") {
            var obj = {};
            obj.status = 10
            ajax(service_prefix.resources, "/picture/changeStatus?ids=" + id + "&status=" + obj.status, 'post').then(function (res) {
                if (res.success) {
                    $("#form9").hide();
                    $("#videos1").attr("src","");
                    $("#list1").show();
                    getTreeData()
                    localStorage.setItem("videoId", "")
                }
            })
        } else {
            var obj = {};
            var status = 20
            ajax(service_prefix.resources, "/picture/changeStatus?ids=" + id + "&status=" + status, "post").then(function (res) {
                if (res.success) {
                    $("#form9").hide();
                    $("#videos1").attr("src","");
                    $("#list1").show();
                    getTreeData()
                    localStorage.setItem("videoId", id)
                }
            })
        }
    }

    layui.form.on("submit(saveWaterMark)", function (data) {
//      localStorage.setItem("width",data.field.width)
//      localStorage.setItem("height",data.field.height)
        localStorage.setItem("videosupForm", data.field.supForm)
        localStorage.setItem("upsize", data.field.upsize)
        localStorage.setItem("markId", data.field.waterMark)
        layer.closeAll();
        return false;
    })
    var colors = "", alpha = "", fontSize = "";

</script>
<script type="text/html" id="syPage">
    <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
        <ul class="layui-tab-title" id="title" style="width: 400px;margin: 30px auto">
            <li class="layui-this">图片水印</li>
            <li>文字水印</li>
        </ul>
        <div class="layui-tab-content" style="height: 100px;">
            <div class="layui-tab-item layui-show" style="width: 400px;margin: 30px auto">
                <form class="layui-form">
                    <div class="layui-form-item">
                        <div class="layui-upload">

                            <div class="layui-upload-list" style="float: left;">
                                <img class="layui-upload-img" id="demo1" style="width: 200px;height: 60px">
                                <p id="demoText"></p>
                            </div>
                            <button type="button" class="layui-btn" id="test12" style="float: left;margin: 16px">上传图片</button>

                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 50px;padding: 9px 0">位置：</label>
                        <div class="layui-input-block" style="margin-left: 50px;width: 350px">

                            <select name="" id="">
                                <option value="正中">正中</option>
                                <option value="左上">左上</option>
                                <option value="顶部">顶部</option>
                                <option value="左侧">左侧</option>
                                <option value="右侧">右侧</option>
                                <option value="左下">左下</option>
                                <option value="底部">底部</option>
                                <option value="右下">右下</option>
                                <option value="铺满">铺满</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item" style="float: left">
                        <label class="layui-form-label" style="width: 70px;padding: 9px 0">透明度：</label>
                        <div class="layui-input-block" style="    margin-left: 75px;margin-top: 15px;;width: 330px">
                            <div id="slideTest5" class="demo-slider"></div>
                        </div>
                    </div>
                    <div class="layui-form-item" style="float: left">
                        <label class="layui-form-label" style="width: 50px;padding: 9px 0">大小：</label>
                        <div class="layui-input-block" style="    margin-left: 75px;margin-top: 15px;;width: 350px">
                            <div id="slideTest6" class="demo-slider"></div>
                        </div>
                    </div>
                    <div class="layui-btn-containen">
                        <button class="layui-btn " type="button">确定</button>
                        <button class="layui-btn  layui-btn-primary" type="button" onclick="layer.closeAll()">取消</button>
                    </div>
                </form>
            </div>
            <div class="layui-tab-item" style="width: 400px;margin: 30px auto">
                <form class="layui-form">
                    <div class="layui-form-item">
                        <div class="layui-input-block" style="margin-left: 0;width: 400px">
                            <input type="text" class="layui-input" name="content">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block" style="margin-left: 0;width: 330px;display: inline-block;">
                            <select name="inputFont" id="">
                                <option value="默认">默认</option>
                                <option value="仿宋">仿宋</option>
                                <option value="楷体">楷体</option>
                                <option value="宋体">宋体</option>
                                <option value="黑体">黑体</option>
                            </select>
                        </div>
                        <div style="margin-left: 10px;display: inline-block;">
                            <div id="test11"></div>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label" style="width: 50px;padding: 9px 0">位置：</label>
                        <div class="layui-input-block" style="margin-left: 50px;width: 350px">

                            <select name="location" id="">
                                <option value="5">正中</option>
                                <option value="1">左上</option>
                                <option value="2">顶部</option>
                                <option value="4">左侧</option>
                                <option value="6">右侧</option>
                                <option value="7">左下</option>
                                <option value="8">底部</option>
                                <option value="9">右下</option>

                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item" style="float: left">
                        <label class="" style="width: 70px;padding: 9px 0">透明度：</label>
                        <div class="layui-input-block" style="    margin-left: 75px;margin-top: 15px;;width: 330px">
                            <div id="slideTest3" layui-form-labelclass="demo-slider"></div>
                        </div>
                    </div>
                    <div class="layui-form-item" style="float: left">
                        <label class="layui-form-label" style="width: 50px;padding: 9px 0">大小：</label>
                        <div class="layui-input-block" style="    margin-left: 75px;margin-top: 15px;;width: 350px">
                            <div id="slideTest4" class="demo-slider"></div>
                        </div>
                    </div>
                    <div class="layui-btn-containen">
                        <button class="layui-btn " type="button" lay-submit lay-filter="addShuiyin">确定</button>
                        <button class="layui-btn  layui-btn-primary" type="button" onclick="layer.closeAll()">取消</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

</script>

<script type="text/html" id="columnDetailTpl">
    <button class="layui-btn" type="button" onclick="editColumn('{{d.id}}')">修改栏目</button>
    <table class="layui-table" style="width: 75%" lay-even="" lay-skin="row" id="info">
        <colgroup>
            <col width="20%">
            <col width="">
            <col>
        </colgroup>
        <tbody>
        <tr>
            <td>状态：</td>
            <td>{{d.status==0?"启用":"停用"}}</td>
        </tr>
        <tr>
            <td>所属站点：</td>
            <td id="columnSiteName"></td>
        </tr>
        <tr>
            <td>唯一标识：</td>
            <td>{{d.skuNumber}}</td>
        </tr>
        <tr>
            <td>栏目名称：</td>
            <td>{{d.name}}</td>
        </tr>
        <tr>
            <td>首页展示模板：</td>
            <td style="cursor: pointer;" onclick="editTemplate('{{d.listtpl}}')">{{d.listtplName}}</td>
        </tr>
        <tr>
            <td>细览编辑模板：</td>
            <td style="cursor: pointer;" onclick="editTemplate('{{d.edittpl}}')">{{d.edittplName}}</td>
        </tr>
        <tr>
            <td>细览展示模板：</td>
            <td style="cursor: pointer;" onclick="editTemplate('{{d.detailtpl}}')">{{d.detailtplName}}</td>
        </tr>
        <tr>
            <td>元数据名称：</td>
            <td style="cursor: pointer;" id="columnTableName" onclick="showTab('metadataFieldTab');"></td>
        </tr>
        <tr>
            <td>发布地址：</td>
            <td><a target="_blank" href="/pub{{d.chnlDataPath}}/list.html">/pub{{d.chnlDataPath}}/list.html</a></td>
        </tr>
        </tbody>
    </table>
</script>
<script type="text/html" id="templetTpl">
    <form class="layui-form" lay-filter="templetForm">
        <div class="layui-card">
            <div class="layui-card-body" style="padding: 25px 15px;    height: 780px;">

                <div class="layui-form-item form-item-inline" style="width: 500px">
                    <label class="layui-form-label">模板名称:</label>
                    <div class="layui-input-block">
                        <input type="text" name="tempname" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">模板类型:</label>
                    <div class="layui-input-block">
                        <select name="temptype" class="layui-input" required lay-verify="required">
                            <option value="1">概览模板</option>
                            <option value="2">细览模板</option>
                            <option value="3">嵌套模板</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">输出文件名:</label>
                    <div class="layui-input-block">
                        <input type="text" name="outputfilename" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">扩展名:</label>
                    <div class="layui-input-block">
                        <input type="text" name="tempext" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">站点:</label>
                    <div class="layui-input-block">
                        <span>{{d.siteName}}</span>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">模板描述:</label>
                    <div class="layui-input-block" style="display: inline-block;margin-left: 0">
                        <textarea class="layui-textarea" style="height: 55px;min-height: 0;width: 1010px;" name="tempdesc"></textarea>
                    </div>
                    <div class="layui-upload" style="    position: absolute;display: inline-block;
    margin-left: 50px;
    margin-top: 12px;">
                        <button type="button" class="layui-btn" id="test1" style="display: inline-block">上传模板缩略图</button>
                        <div class="layui-upload-list" style="display: inline-block;position: absolute;
    left: 140px;
    top: -20px;    height: 50px;
    width: 120px;
    border: 1px solid;
    margin-left: 10px">
                            <img class="layui-upload-img" id="demos1" style="width: 100%;height: 100%">
                            <p id="demoText"></p>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">模板文本:</label>
                    <div class="layui-input-block">
                        <textarea class="layui-textarea" style="height: 673px;padding-top: 7px;line-height: 18px!important;" name="temphtml" id="text1"></textarea>
                    </div>
                </div>

            </div>
        </div>
        <div class="button-bar">
            <button class="layui-btn" lay-submit lay-filter="addTemplet">提交</button>
            <button class="layui-btn" type="button" data-type="close">返回</button>
        </div>
        <input type="hidden" name="id">
        <input type="hidden" name="siteid">
    </form>
</script>
<script type="text/html" id="columnTpl">
    <form class="layui-form" lay-filter="columnForm">
        <div class="layui-card-body">
            <div class="layui-form-item">
                <label class="layui-form-label">状态:</label>
                <div class="layui-input-block">
                    <input type="radio" name="stop" checked value="0" title="启用">
                    <input type="radio" name="stop" value="1" title="停用">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">所属站点:</label>
                <div class="layui-input-block">
                    <span>{{d.siteName}}</span>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">父栏目:</label>
                <div class="layui-input-block">
                    <span>{{d.parentName}}</span>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">栏目类型:</label>
                <div class="layui-input-block">
                    <select name="" class="layui-input" required lay-verify="required">
                        <option value="1">普通栏目</option>
                        <option value="2">图片新闻</option>
                        <option value="3">头条栏目</option>
                        <option value="4">链接栏目</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">唯一标识:</label>
                <div class="layui-input-block">
                    <input type="text" name="skuNumber" required lay-verify="required" placeholder="请输入"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">栏目名称:</label>
                <div class="layui-input-block">
                    <input type="text" name="name" required lay-verify="required" placeholder="请输入"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">前一个栏目:</label>
                <div class="layui-input-block">
                    <select class="layui-input" id="chnlOrder" name="chnlOrder">
                    </select>
                </div>
            </div>
            <input type="hidden" name="id">
            <div class="button-bar">
                <button type="button" class="layui-btn" lay-submit lay-filter="addColumn">确定</button>
                <button type="button" class="layui-btn layui-btn-primary" onclick="layer.closeAll();">取消</button>
            </div>
        </div>
        <input type="hidden" name="siteId">
        <input type="hidden" name="parentId">
        <input type="hidden" name="id">
    </form>
</script>
<script type="text/html" id="columnListTmpl">
    {{#layui.each(d, function(index, item){}}
    <li id="{{item.id}}" order="{{item.chnlOrder}}">
        <form class="layui-form" action="">
            <div class="layui-form-item" pane="">
                <div class="layui-input-block">
                    <input type="checkbox" name="ids" lay-skin="primary" id="check" value="{{item.id}}">
                </div>
            </div>
            <div class="chanelName">{{item.name}}</div>
        </form>
        <div class="bottom">
            <img src="../../common/img/u5722.png" alt="" onclick="editColumn('{{item.id}}')">
            <img src="../../common/img/u5725.png" alt="" onclick="getColumnById('{{item.id}}')">
            <img onclick="delColumn1('{{item.id}}',1)" src="../../common/img/u5729.png" alt="" srcset="">
        </div>
    </li>
    {{#}) }}
    <li>
        <button type="button" onclick="addImgColumn()" class="layui-btn"></button>
    </li>
</script>


<!-- 新加审核功能 -->
<script type="text/html" id="shTemplate">
    <form action="" class='layui-form'>
    <div class="layui-form-item">
    <label class="layui-form-label">审核状态：</label>
     
    <div class="layui-input-block">
      <input type="radio" name="sex" value="审核通过" title="审核通过" checked="">
      <input type="radio" name="sex" value="审核不通过" title="审核不通过">
    </div>
    </div>
    <label class="layui-form-label">审核理由：</label>
    <textarea name="" id="reson" rows=6 cols=30 placeholder="请输入描述理由"  ></textarea>
    </form>
</script>

<script>
    $("#passAll").click(function (data) {
        layer.open({
            title: '审核',
            area: ['500px', '300px'],
            content: '<div class="drwb"></div>',
            btn: ['确定', '取消'],
            yes: function (index, layero) {
                layer.close(index);
            },
            btn2: function (index, layero) {
                layer.close(index);
            },
            cancel: function (index, layero) {
                layer.close(index);
            }
        })
        layui.laytpl($("#shTemplate").html()).render(data, function (html) {
            $(".drwb").html(html)
            setRender();
        });
    })
</script>


<!-- 转发功能 -->
<script type="text/html" id="tuisongTemplate">
    <form action="" class="layui-form">
        <p>请选择推送渠道:</p>
        <div
                 class="layui-inline">
            <div
                     class="layui-input-block"><select name="">
                <option
                         value="">请选择</option>
                <option
                         value="">推送到网站渠道</option>
                <option
                         value="">推送到第三方渠道</option>
                </select></div>
        </div>
        <p>请选择推送站点:</p>
        <div
                 class="layui-inline">
            <div
                     class="layui-input-block"><select name="">
                <option
                         value="">请选择</option>
                <option
                         value="">中科聚网公众号</option>
                <option
                         value="">中科聚网微博号</option>
                </select></div>
        </div>
    </form>
</script>

<script>
    $("#unpassAll").click(function (data) {
        layer.open({
            title: '推送',
            area: ['500px', '320px'],
            content: '<div class="tuisong"></div>',
            btn: ['确定', '取消'],
            yes: function (index, layero) {
                layer.close(index);
            },
            btn2: function (index, layero) {
                layer.close(index);
            },
            cancel: function (index, layero) {
                layer.close(index);
            }
        })
        layui.laytpl($("#tuisongTemplate").html()).render(data, function (html) {
            $(".tuisong").html(html)
            setRender();
        });
    })
</script>
</body>

</html>