<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>CodeMirror: Formatting Demo</title>
    <link rel="stylesheet" href="../lib/codemirror.css">
    <script src="../lib/codemirror.js"></script>
    <link rel="stylesheet" href="../theme/night.css">
    <link rel="stylesheet" href="../theme/monokai.css">
    <script src="../lib/util/simple-hint.js"></script>
    <link rel="stylesheet" href="../lib/util/simple-hint.css">
    <script src="../lib/util/javascript-hint.js"></script>
    <script src="../lib/util/formatting.js"></script>
    <script src="../mode/css/css.js"></script>
    <script src="../mode/xml/xml.js"></script>
    <script src="../mode/javascript/javascript.js"></script>
    <script src="../mode/htmlmixed/htmlmixed.js"></script>
<!--    <link rel="stylesheet" href="../doc/docs.css">-->
    <link rel="stylesheet" href="../lib/util/simple-hint.css">
    <script src="../lib/util/javascript-hint.js"></script>
    <script src="../mode/javascript/javascript.js"></script>
</head>
<body>

<form><textarea id="code" name="code"></textarea></form>
<table>
    <tr>
        <td>
            <a href="javascript:autoFormatSelection()">
                Autoformat Selected
            </a>
        </td>
        <td>
            <a href="javascript:commentSelection(true)">
                Comment Selected
            </a>
        </td>
        <td>
            <a href="javascript:commentSelection(false)">
                Uncomment Selected
            </a>
        </td>
    </tr>
</table>
</p>
</body>

<style type="text/css">
    .CodeMirror {
        border: 1px solid #eee;
    }
    .CodeMirror-scroll {
        min-height: 900px;
    }

    td {
        padding-right: 20px;
    }
</style>

<script>
    CodeMirror.commands.autocomplete = function (cm) {
        CodeMirror.simpleHint(cm, CodeMirror.javascriptHint);
    }
    var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
        lineNumbers: true,
        indentUnit: 4,
        mode: "htmlmixed",
        lineWrapping: true,
        extraKeys: {"Alt-D": "autocomplete"},
        onBlur: function () {
            editor.save()
        }
    });
    CodeMirror.commands["selectAll"](editor);
    let html = `<div id="widget_text_id_9" class="draggable-text ui-draggable ui-draggable-handle w_text" style="position: absolute; top: 24px; left: 173px; z-index: 18; width: 250px; height: 29px;"> <div class="text_content border_content" style="font-family: 微软雅黑; font-size: 22px; line-height: 1.5; color: rgb(255, 255, 255); text-decoration: none; font-style: normal; font-weight: normal; text-align: left;"> E-安保一体化运营平台 </div> </div>  <div id="widget_image_id_3" class="draggable-image ui-draggable ui-draggable-handle w_image" style="position: absolute; top: 20px; left: 73px; z-index: 33;"> <div class="content border_content" src="../upload/images/logo1.png"> <img src=" ../upload/images/logo1.png " style="width: 82px; height: 41px; border-radius: 0px;"> </div> </div>  <div id="widget_login_id_0" class="draggable-login ui-draggable ui-draggable-handle w_login" style="top: 166px; left: 1067px; z-index: 34;"> <div class="content border_content"> <div class="login_user">  <div class="qr_tab1"> <img src="../images/qr1.png" style="float: right"> </div>  <div class="layui-tab layui-tab-brief"> <ul class="layui-tab-title">  <li class="layui-this username_login">账号密码</li>   <li class="phone_login">手机号验证码</li>   </ul> <div class="layui-tab-content">  <div class="layui-tab-item layui-show username_login"> <form action="" class="layui-form"> <div class="layui-form-item"> <div class="layui-input-inline"> <i class="layui-icon layui-icon-username w_login_icon"></i> <input type="text" class="layui-input w_login_text" lay-verify="username" name="username" placeholder="请输入账号"> </div> </div> <div class="layui-form-item"> <div class="layui-input-inline"> <i class="layui-icon layui-icon-password w_login_icon"></i> <input type="password" class="layui-input w_login_text" lay-verify="password" name="password" placeholder="请输入密码"> </div> </div>  <div class="layui-form-item vercode_item"> <div class="layui-input-inline"> <i class="layui-icon layui-icon-vercode w_login_icon"></i> <input type="text" class="layui-input w_login_vercode" lay-verify="required" name="vercode" placeholder="请输入验证码"> </div> <img class="vercode_img" src="http://123.57.20.137:8080/member/home/imgCode?t=1646115269387"> </div>  <div class="layui-form-item position_r m_t_15 password"> <div class="layui-input-inline"> <input type="checkbox" name="remember" lay-skin="primary" title="记住密码" lay-filter="remember"><div class="layui-unselect layui-form-checkbox" lay-skin="primary"><span>记住密码</span><i class="layui-icon layui-icon-ok"></i></div> </div> <a class="forget_password" href="#">忘记密码？</a> </div> <button type="submit" class="layui-btn layui-bg-green layui-btn-fluid" lay-submit="" lay-filter="username_login">登录 </button> </form> </div>    <div class="layui-tab-item phone_login">   <form action="" class="layui-form"> <div class="layui-form-item"> <div class="layui-input-inline"> <i class="layui-icon layui-icon-username w_login_icon"></i> <input type="text" class="layui-input w_login_text" name="phone" lay-verify="phone" placeholder="请输入11位手机号"> </div> </div> <div class="layui-form-item"> <div class="layui-input-inline"> <i class="layui-icon layui-icon-vercode w_login_icon"></i> <input type="text" class="layui-input w_login_vercode" name="vercode2" placeholder="请输入验证码"> </div> <button class="layui-btn layui-bg-green vercode_btn">获取验证码 </button> </div> <div class="layui-form-item position_r m_t_15 password"> <div class="layui-input-inline"> <input type="checkbox" name="remember" lay-skin="primary" title="记住密码" lay-filter="remember"><div class="layui-unselect layui-form-checkbox" lay-skin="primary"><span>记住密码</span><i class="layui-icon layui-icon-ok"></i></div> </div> <a class="forget_password" href="#">忘记密码？</a> </div> <button type="submit" class="layui-btn layui-bg-green layui-btn-fluid" lay-submit="" lay-filter="phone_login">登录 </button> </form> </div>  </div>  <fieldset class="layui-elem-field layui-field-title third_login"> <legend class="third_login">第三方登录</legend> <div class="layui-field-box login-icon third_login">  <i class="layui-icon layui-icon-login-wechat wechat_login"></i>   <i class="layui-icon layui-icon-login-qq qq_login"></i>  </div> </fieldset>  </div> </div> <div class="login_qr" style="display: none"> <div class="qr_tab2"> <img src="../images/qr2.png" style="float: right"> </div> <div class="layui-tab layui-tab-brief"> <ul class="layui-tab-title"> <li class="layui-this">扫码登录</li> </ul> <div class="layui-tab-content"> <div class="layui-tab-item layui-show qr_container"> <div class="qr_border"> <img class="qr_code" src="../images/qr_code.png"> </div> <div>请使用APP扫描二维码登录</div> </div> </div> </div> </div> </div> </div>`;
    editor.setValue(html);
    editor.setOption("theme", "monokai");
    let num = editor.lineCount();
    editor.autoFormatRange({line: 0, ch: 0}, {line: num});
    editor.setCursor({line: 0, ch: 0});
    let codemirrorScroll = document.getElementsByClassName('CodeMirror-scroll')[0];
    editor.setSize('auto', codemirrorScroll.scrollHeight + 'px');
    console.log(editor.getValue());



    function getSelectedRange() {
        return {from: editor.getCursor(true), to: editor.getCursor(false)};
    }

    function autoFormatSelection() {
        var range = getSelectedRange();
        editor.autoFormatRange(range.from, range.to);
    }

    function commentSelection(isComment) {
        var range = getSelectedRange();
        editor.commentRange(isComment, range.from, range.to);
    }
</script>

</html>
