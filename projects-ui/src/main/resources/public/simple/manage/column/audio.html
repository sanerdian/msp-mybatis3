<!DOCTYPE html>
<html lang="en">


<link rel="stylesheet" href="thirdparty/tree/css/metroStyle/metroStyle.css">
<link rel="stylesheet" href="common/css/column.css">
<style>
    #nav span, .right span {
        display: none;
    }

    #nav a {
        display: inline-block;
        width: 40px;
        height: 56px;
        text-align: center;
        border: 1px solid #f5f5f5;
    }

    #nav a:nth-of-type(3) {
        display: inline-block;
        width: 220px;
        height: 52px;
        text-align: left;
        padding-left: 20px;
        border-top: 2px solid #000;
        font-weight: bold;
    }

    .right {
        display: inline-block;
        position: absolute;
        top: 0;
        right: 0;
    }

    .layui-breadcrumb a {
        color: #000 !important;
    }

    #nav span,
    .right span {
        display: none;
    }

    .videos {
        display: none;
        width: 795px;
        height: 464px;
        background: url(./img/u6147.png) no-repeat;
        background-size: 100% 100%;
        position: absolute;
        top: 0;
        left: 0
    }

    #nav a {
        display: inline-block;
        width: 40px;
        height: 56px;
        text-align: center;
        border: 1px solid #f5f5f5;
    }

    #nav a:nth-of-type(3) {
        display: inline-block;
        width: 220px;
        height: 52px;
        text-align: left;
        padding-left: 20px;
        border-top: 2px solid #000;
        font-weight: bold;
    }

    .right {
        display: inline-block;
        position: absolute;
        top: 0;
        right: 0;
    }

    .layui-breadcrumb a {
        color: #000 !important;
    }

    .node_name {
        font-size: 18px;
        color: rgb(102, 102, 102);
        margin-top: -5px;
        display: inline-block;
    }

    #list1 .layui-table td {
        padding: 0;
    }

    .imgBox {
        margin-top: 20px;
        margin-left: 30px;
    }

    .imgBox li {
        width: 230px;
        height: 180px;
        background: url(./img/transparent.gif) no-repeat;
        background-size: 100% 100%;
        float: left;
        margin-right: 25px;
        margin-bottom: 5px;
    }

    .imgBox li .img {
        width: 230px;
        height: 150px;
        background: url(./img/u8901.png) no-repeat;
        background-size: 100% 100%;
        position: relative;
    }

    .imgBox1 li {
        width: 100%;
        height: 115px;
        border-bottom: 1px solid #f5f5f5;
        position: relative;
    }

    .imgBox1 li .right {
        width: 140px;
        height: 70px;
        background: url(./img/u8901.png) no-repeat;
        background-size: 100% 100%;
        position: absolute;
        top: 10px;
        left: 15px;
    }

    .imgBox1 li .content {
        height: 70px;
        position: absolute;
        top: 10px;
        left: 175px;
    }

    .layui-table tbody tr:hover {
        background: #fff;
    }

    td .layui-input, .layui-select, .layui-textarea {
        border: none;
    }

    .inner1 li {
        float: left;
        margin-left: 15px;
    }

    .inner1 li:last-child {
        width: 175px;
        height: 197px;
        background: #f6f6f6;
        margin-top: 10px;
        position: relative;
    }

    .inner1 li:last-child img {
        position: absolute;
        top: 40px;
        left: 30px;
    }

    #form2 .layui-form-select .layui-edge, #form3 .layui-form-select .layui-edge {
        position: absolute;
        right: 10px;
        top: 75%;
    }

    .box {
        width: 1050px;
        height: 520px;
        margin-left: 95px;
        background: #fff;
        padding: 10px 0 0 10px;
        border-radius: 2px;
    }

    .layui-layer-hui .layui-layer-content {
        padding: 0 25px;
    }

    .prev {
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: #ccc;
        position: absolute;
        line-height: 60px;
        top: 250px;
        left: 30px;
    }

    .next {
        width: 60px;
        height: 60px;
        border-radius: 30px;
        background: #ccc;
        position: absolute;
        line-height: 60px;
        top: 250px;
        right: 30px;
    }

    .image {
        width: 600px;
        height: 464px;
        background-size: 100% 100%;
    }

    .left {
        float: left;
        margin-right: 20px;
    }

    .rights {
        float: left;
        width: 350px;
    }

    .layui-layer-hui {
        background: rgba(0, 0, 0, 0);
    }

    .node_name {
        font-size: 14px;
    }

    /*#upload_preview{*/
    /*width: 230px;*/
    /*height: 146px;*/
    /*background: url(./img/u8901.png) no-repeat;*/
    /*}*/
</style>

<div class="layui-fluid">
    <div class="layui-row layui-col-space12">
        <div class="layui-tab-item layui-show">
            <div class="layui-card " id='list1' style="height: 700px">
                <form class="layui-form" style="display: inline-block;margin-top: 10px">
                    <div class="layui-form-item" style="display: inline-block;">
                        <label class="layui-form-label"
                               style="padding: 9px 10px;width:35px;text-align:center">名称:</label>
                        <div class="layui-input-block" style="width: 130px;margin-left: 60px;">
                            <input type="text" class="layui-input" placeholder="请输入" id="name">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display: inline-block;">
                        <label class="layui-form-label"
                               style="padding: 9px 10px;width:50px;text-align:center">创建者:</label>
                        <div class="layui-input-block" style="width: 130px;margin-left: 70px;">
                            <input type="text" class="layui-input" placeholder="请输入" id="crUser">
                        </div>
                    </div>
                    <div class="layui-form-item" style="display: inline-block;">
                        <label class="layui-form-label"
                               style="padding: 9px 0 9px 15px;width:56px;text-align:center">上传时间</label>
                        <div class="layui-input-block" style="width: 250px;margin-left: 75px;">
                            <input type="text" class="layui-input" id="t12" placeholder=" - "
                                   style="text-align: center">
                        </div>
                    </div>
                </form>
                <div class="layui-btn-container"
                     style="display: inline-block;width: 520px;margin-left: 10px;">
                    <button class="layui-btn" onclick="search()"><i class="layui-icon layui-icon-search"></i></button>
                    <button class="layui-btn" onclick="delaudios()">批量删除</button>
                    <button class="layui-btn" onclick="zCode()">批量转码</button>
                    <button class="layui-btn" onclick="createCodes()">资源发布</button>
                    <button class="layui-btn" data-method="upload" type="button" id="uploads">音频上传</button>
                </div>
                <div class="layui-form">
                    <table class="layui-table">
                        <colgroup>
                            <col width="130">
                            <col width="100">
                            <col width="100">
                            <col width="120">
                            <col>
                            <col width="40">
                            <col width="40">
                        </colgroup>
                        <tbody>
                        <tr>
                            <td>
                                <div class="layui-input-block" style="margin-left: 0;">
                                    <select name="" id="">
                                        <option value="0" selected>默认排序</option>
                                        <option value="1">上传时间排序</option>
                                        <option value="2">文件大小排序</option>
                                    </select>
                                </div>
                            </td>
                            <td>
                                <div class="layui-input-block" style="margin-left: 0;">
                                    <select name="" id="" lay-filter="time">
                                        <option value="" selected>时长</option>
                                        <option value="1">5以内</option>
                                        <option value="2">5~30</option>
                                        <option value="3">30以上</option>
                                    </select>
                                </div>
                            </td>
                            <td>
                                <div class="layui-input-block" style="margin-left: 0;">
                                    <select name="form" id="" lay-verify="required" lay-filter="forms">
                                        <option value="" disabled selected hidden>格式</option>
                                        <option value="全部">全部</option>
                                        <option value="MP3">MP3</option>
                                        <option value="WAV">WAV</option>
                                        <option value="wma">wma</option>
                                        <option value="asf">asf</option>
                                        <option value="其他">其他</option>
                                    </select>
                                </div>
                            </td>
                            <td>
                                <div class="layui-input-block" style="margin-left: 0;">
                                    <select name="form" id="" lay-verify="required" lay-filter="copyright">
                                        <option value="" disabled selected hidden>版权归属</option>
                                        <option value="全部">全部</option>
                                        <option value="自主">自主</option>
                                        <option value="经授权">经授权</option>
                                        <option value="其他">其他</option>
                                    </select>
                                </div>
                            </td>
                            <td>
                                <div class="layui-input-block" style="margin-left: 0;">
                                    <select name="form" id="" lay-verify="required" lay-filter="state">
                                        <option value="" disabled selected hidden>音频状态</option>
                                        <option value="0">新稿</option>
                                        <option value="10">审核</option>
                                        <option value="20">发布</option>
                                    </select>
                                </div>
                            </td>
                            <td style="width: 470px"></td>
                            <td class="img1">
                                <img src="./img/u6616_mouseOver.png" alt="" srcset="" style="margin-left: 10px;"
                                     id='change1'>
                            </td>
                            <td class="img1">
                                <img src="./img/u6611.png" alt="" srcset="" style="margin-left: 10px;" id='change2'>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <ul class="imgBox" id="audio" style="height: 490px;overflow: auto">


                    </ul>
                    <ul class="imgBox1" style="display: none;height: 490px;overflow: auto" id="audio1">

                    </ul>
                    <div id="test1" style="margin: 10px 0 0 30px;"></div>
                </div>
            </div>
            <div class="layui-card " id='list2' style="display: none;height: 700px">
                <div class="layui-card-header"><p style="color: #0000ff;cursor: pointer;" onclick='returnBack()'>
                    返回上一级</p></div>
                <div class="layui-card-body">
                    <div class='inner' style="width: 695px;height:234px;margin: 180px auto">
                        <form class="layui-form" method="post" action="javascript:;">

                            <div class="layui-form-item">

                                <div class="layui-inline">
                                    <div class="layui-upload-drag" id="chooseFile">
                                        <p style="width: 100%;position: relative;left: -30px;"><i
                                                class="layui-icon layui-icon-upload" style="font-size: 35px"></i>&nbsp;&nbsp;&nbsp;<span
                                                style="position: absolute">点击上传</span></p>
                                        <p style="margin-top:20px; color:#ccc;text-align: center;">
                                            --------------------------------------&nbsp;&nbsp;或&nbsp;&nbsp;--------------------------------------</p>
                                        <p style="margin-top:20px; color:#0000ff;text-align: center;font-size: 20px;">
                                            从电脑里拖拽音频至此上传</p>
                                        <p style="margin-top:20px; color:#ccc;text-align: center;color:#ccc;">
                                            支持mp3,asf,wma...等格式,图像大于72dpi,宽度大于2000px;（批量上传每次上限300个）</p>
                                    </div>
                                </div>

                            </div>

                        </form>
                    </div>
                </div>

            </div>
            <div class="layui-card h100" id='list3' style="display: none;height: 700px">
                <div class="layui-card-header"><p style="color: #0000ff;cursor: pointer;" onclick='returnBack1()'>
                    返回上一级</p></div>
                <div class="layui-card-body">

                    <div class="inner1">
                        <div class="layui-main">
                            <div class="layui-inline" id="upload_preview"></div>
                        </div>
                        <form class="layui-form" style="margin-top: 480px">
                            <div class="layui-form-item">
                                <div class="layui-input-block" style="margin-left: 0">
                                    <input type="checkbox" lay-filter="check" lay-skin="primary" title="按默认设置处理（转码）">
                                </div>
                            </div>
                        </form>
                        <div class="edit" style="position: relative">
                            <button class="layui-btn layui-btn-normal layui-btn-lg"
                                    style="width: 265px;margin-top: 10px;display: inline-block;" onclick="edit()"><i
                                    class="layui-icon layui-icon-upload"></i>编辑音频
                            </button>
                            <span style="margin-left: 15px;color:#666;display: inline-block;height: 44px;position: absolute;top:10px;line-height: 44px;">共3条音频（上传过程中请不要删除原始音频）</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-card h100" id='list5' style="display: none;height: 700px">
                <div class="layui-card-header"><p style="color: #0000ff;cursor: pointer;" onclick='returnBack3()'>
                    返回上一级</p></div>
                <div class="layui-card-body">
                    <div class="inner3">
                        <h3 style="color: #169BD5;margin-left: 500px;margin-top:20px;font-weight:bold;display: inline-block;">
                            单独新建信息</h3>
                        <div class="infoBox"
                             style="width: 420px;height:610px;border-left:1px solid #ccc;float:right;margin-top: 60px;overflow: auto;">
                            <form class="layui-form" id='form3'>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">视频名称</label>
                                    <div class="layui-input-block" style="margin-left: 15px;width:380px;">
                                        <input type="text" class="layui-input" placeholder="请输入内容">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">*版权归属</label>
                                    <div class="layui-input-block" style="margin-left:15px;width:380px;">
                                        <select name="" id="">
                                        </select>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">来源</label>
                                    <div class="layui-input-block" style="margin-left: 15px;width:380px;">
                                        <input type="text" class="layui-input" placeholder="请输入内容">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">*描述</label>
                                    <div class="layui-input-block" style="margin-left: 15px;width:380px;">
                                        <textarea class="layui-textarea" style="border: 1px solid #ccc"></textarea>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">文件夹路径</label>
                                    <div class="layui-input-block" style="margin-left: 15px;width:380px;">
                                        <input type="text" class="layui-input" placeholder="请输入内容">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">格式</label>
                                    <div class="layui-input-block" style="margin-left:15px;width:380px;">
                                        <select name="" id="">
                                            <option value="0" selected>MP3</option>
                                            <option value="1">WAV</option>
                                            <option value="2">ASF</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">文件大小</label>
                                    <div class="layui-input-block" style="margin-left: 15px;width:380px;">
                                        <input type="text" class="layui-input" value="52.82kB">
                                    </div>
                                </div>

                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">时长</label>
                                    <div class="layui-input-block" style="margin-left: 15px;width:380px;">
                                        <input type="text" class="layui-input" value="05：55">
                                    </div>
                                </div>
                                <div class="layui-form-item">
                                    <label class="layui-form-label" style="text-align: left;">版式</label>
                                    <div class="layui-input-block" style="margin-left:15px;width:380px;">
                                        <select name="" id="">
                                            <option value="0" selected>横版</option>
                                            <option value="1">竖版</option>
                                            <option value="2">方版</option>
                                        </select>
                                    </div>
                                </div>
                            </form>
                            <button class="layui-btn layui-btn-normal" style="width: 310px;margin:20px 0 0 50px;">确定
                            </button>
                        </div>
                        <div class="imgIcon"
                             style="width:379px;height:466px;margin: 50px 0 0 150px;position: relative;">
                            <!-- <img src="./img/u6733.jpg" alt="" srcset="" style="width: 100%;height:100%;"> -->
                            <img src="./img/u7603.png" alt="" srcset=""
                                 style="position: absolute;width: 60px;height: 60px;;position: absolute;top:50%;left:50%;margin: -30px 0 0 -30px;">
                        </div>
                        <div class="layui-btn-container" style="margin: 20px 150px;">
                            <button class="layui-btn layui-btn-normal" style="margin-right: 115px;"><i
                                    class="layui-icon layui-icon-left"></i></button>
                            <button class="layui-btn layui-btn-normal" style="margin-left: 150px;"><i
                                    class="layui-icon layui-icon-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="layui-card h100" id='list7' style="display: none;height: 700px">
                <div class="layui-card-header"><p style="color: #0000ff;cursor: pointer;" onclick='returnBack5()'>
                    返回上一级</p></div>
                <div class="layui-card-body">
                    <div class="inner5" id="inner5">

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="audios">
    {{# layui.each(d, function(index, item){ }}
    <li>
        <div class="img">
            <!--<img src="{{'/files' + item.path.substring(9)}}"  style="width: 100%;height: 100%">-->
            <div class="checkDiv">
                <input type="checkbox" name="ids" lay-skin="primary" id="check" lay-filter="checked"
                       value="{{item.id}}">
            </div>
            <div class="layui-btn-container" style="position: absolute;right:0px;top:5px;">
            </div>
            <div style="width: 40px;height:40px;    position: absolute;
    top: 55px;
    left: 95px;" onclick="preview('{{item.id}}',event)">
                <img src="./img/u7603.png" alt="" style="width: 100%;height:100%;">
            </div>
        </div>
        <div class="text" style="margin-top:10px;height: 20px;width: 240px;overflow: hidden;
text-overflow:ellipsis;white-space: nowrap;">

            {{#if(item.status===0){ }}
            <span style="color: blue">新稿</span>
            {{#} else if(item.status===10){ }}
            <span style="color: blue">审核</span>
            {{#} else if(item.status===20){ }}
            <span style="color: blue">发布</span>
            {{#} }}
            |&nbsp;&nbsp;<span style="text-align: center" title="{{item.name}}.{{item.form}}">{{item.name}}.{{item.form}}</span>
        </div>
    </li>
    {{#  }); }}
    {{# if(d.length === 0){ }}
    无数据
    {{# } }}
</script>
<script type="text/html" id="audios1">
    {{# layui.each(d, function(index, item){ }}
    <li>
        <div class="right">
        </div>
        <div class="content">
            <p>{{item.name}}</p>
            <p style="margin-top: 15px;">
                <span>格式：{{item.form}}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>大小：{{item.size}}KB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>上传时间：2019年7月10日</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>路径：首页 - banner新闻</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>来源：版权来源</span>
            </p>
        </div>
        <div class="layui-btn-container" style="position: absolute;right:20px;top:30px;">

            <div class="layui-btn" onclick="downLoadAudio('{{item.id}}',event)">下载</div>
            <div class="layui-btn layui-btn-danger" onclick="deleteAudios('{{item.id}}',event)">删除</div>
        </div>
    </li>
    {{#  }); }}
    {{# if(d.length === 0){ }}
    无数据
    {{# } }}
</script>
<script>
    var url = '/picture';
    var bool = false;
    var tempSize = 10;
    $(function () {
        getAudioList(1, {})
    }())

    function zCode() {
        var data = document.getElementsByName("ids")
        var ids = "";
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择要转码的音频")
            return false;
        }
        ajax("/picture/transMp3?ids=" + ids, 'post').then(function (res) {
            if (res.success) {
                getAudioList(1, {})
            }
        })
    }

    function changeState(status, id) {
        if (status === "审核") {
            var obj = {};
            obj.status = 10
            ajax("/picture/changeStatus?ids=" + id + "&status=" + obj.status, 'post').then(function (res) {
                if (res.success) {
                    layer.closeAll();
                    var data = {};
                    data.sign = 3;
                    getAudioList(1, data)
                    localStorage.setItem("audioId", "")
                }
            })
        } else {
            var obj = {};
            var status = 20
            ajax("/picture/changeStatus?ids=" + id + "&status=" + status, "post").then(function (res) {
                if (res.success) {
                    layer.closeAll();
                    var data = {};
                    data.sign = 3;
                    getAudioList(1, data)
                    localStorage.setItem("audioId", id)
                }
            })
        }
    }

    function downLoadAudio(id, event) { //下载音频
        event.stopPropagation()
        window.location.href = "/picture/downLoad?id=" + id;
    }

    function createCodes() {
        var data = document.getElementsByName("ids")
        var ids = "";
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择需要发布的音频")
            return false;
        }
        var id = localStorage.getItem("audioId");
        console.log(id)
        if (id && id === ids) {
            layer.alert("该音频已发布过，请重新选择其他音频发布");
            return false
        }
        changeState("发布", ids)
    }

    var startTime = "", endTime = "";
    layui.use('laydate', function () {  //日期显示组件
        var laydate = layui.laydate;
        laydate.render({
            elem: '#t12'
            , range: true
            , done: function (value) {
                startTime = value.split(' -')[0]
                endTime = value.split('- ')[1]
            }
        });

    })

    function search() {
        var crUser = $("#user").val();
        var name = $("#name").val();
        if (!name && !crUser && !startTime && !endTime) {
            getAudioList(1, {})
        } else {
            var obj = {};
            obj.name = name;
            obj.crUser = crUser;
            obj.startTime = startTime;
            obj.endTime = endTime;
            getAudioList(1, obj);
        }
    }

    var forms = "";
    var copyright = "";
    var timeRange = 0;
    var form = layui.form;
    var status;
    form.on('select(state)', function (data) {
        status = data.value

    })
    form.on("select(forms)", function (data) {
        forms = data.value;
    })
    form.on("select(time)", function (data) {
        console.log(data.value);
        switch (data.value) {
            case "0":
                getAudioList(1, {});
                break;
            case "1":
                var obj = {};
                obj.sign = 3;
                curr = 1;
                tempSize = 10;
                var jsonData = {
                    "pager": {
                        "current": curr,
                        "size": tempSize,
                    },
                    "picture": obj
                }
                ajax(url + "/list", 'post', JSON.stringify(jsonData)).then(function (res) {
                    console.log(res);
                    layui.use('laypage', function () {
                        var laypage = layui.laypage;

                        //执行一个laypage实例
                        laypage.render({
                            elem: 'test1'
                            , count: res.obj.total
                            , curr: res.obj.current
                            , limit: res.obj.size
                            , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                            , jump: function (obj, first) {
                                if (!first) {
                                    curr = obj.curr
                                    tempSize = obj.limit
                                    var obj1 = {};
                                    obj1.sign = 3
                                    getAudioList(curr, obj1);
                                }
                            }
                        });
                    });
                    var obj = res.obj.records;
                    var arr = obj.filter(function (item) {
                        return Number(item.length.slice(1, 2)) < 5 || Number(item.length.slice(1, 2)) === 5;
                    })
                    layui.laytpl($("#audios").html()).render(arr, function (html) {
                        $("#audio").html(html);
                        layui.form.render();
                    })
                    layui.laytpl($("#audios1").html()).render(arr, function (html) {
                        $("#audio1").html(html);
                        layui.form.render();
                    })
                })
                break
            case "2":
                var obj = {};
                obj.sign = 3;
                curr = 1;
                tempSize = 10;
                var jsonData = {
                    "pager": {
                        "current": curr,
                        "size": tempSize,
                    },
                    "picture": obj
                }
                ajax(url + "/list", 'post', JSON.stringify(jsonData)).then(function (res) {
                    console.log(res);
                    layui.use('laypage', function () {
                        var laypage = layui.laypage;

                        //执行一个laypage实例
                        laypage.render({
                            elem: 'test1'
                            , count: res.obj.total
                            , curr: res.obj.current
                            , limit: res.obj.size
                            , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                            , jump: function (obj, first) {
                                if (!first) {
                                    curr = obj.curr
                                    tempSize = obj.limit
                                    var obj1 = {};
                                    obj1.sign = 3
                                    getAudioList(curr, obj1);
                                }
                            }
                        });
                    });
                    var obj = res.obj.records;
                    var arr = obj.filter(function (item) {
                        return Number(item.length.slice(1, 2)) > 5 && Number(item.length.slice(1, 2)) < 30;
                    })
                    console.log(arr)
                    layui.laytpl($("#audios").html()).render(arr, function (html) {
                        $("#audio").html(html);
                        layui.form.render();
                    })
                    layui.laytpl($("#audios1").html()).render(arr, function (html) {
                        $("#audio1").html(html);
                        layui.form.render();
                    })
                })
                break
            case "3":
                var obj = {};
                obj.sign = 3;
                curr = 1;
                tempSize = 10;
                var jsonData = {
                    "pager": {
                        "current": curr,
                        "size": tempSize,
                    },
                    "picture": obj
                }
                ajax(url + "/list", 'post', JSON.stringify(jsonData)).then(function (res) {
                    console.log(res);
                    layui.use('laypage', function () {
                        var laypage = layui.laypage;

                        //执行一个laypage实例
                        laypage.render({
                            elem: 'test1'
                            , count: res.obj.total
                            , curr: res.obj.current
                            , limit: res.obj.size
                            , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                            , jump: function (obj, first) {
                                if (!first) {
                                    curr = obj.curr
                                    tempSize = obj.limit
                                    var obj1 = {};
                                    obj1.sign = 3
                                    getAudioList(curr, obj1);
                                }
                            }
                        });
                    });
                    var obj = res.obj.records;
                    var arr = obj.filter(function (item) {
                        return Number(item.length.slice(1, 2)) > 30 && Number(item.length.slice(1, 2)) === 30;
                    })
                    console.log(arr)
                    layui.laytpl($("#audios").html()).render(arr, function (html) {
                        $("#audio").html(html);
                        layui.form.render();
                    })
                    layui.laytpl($("#audios1").html()).render(arr, function (html) {
                        $("#audio1").html(html);
                        layui.form.render();
                    })
                })
                break
        }
    })
    form.on("select(copyright)", function (data) {
        forms = data.value;
    })
    form.on("select", function (data) {
        if (forms === "" || forms === "全部") {
            forms = "";
        }
        if (copyright === "" || copyright === "全部") {
            copyright = "";
        }
        var obj = {};
        obj.copyright = copyright;
        obj.form = forms;
        obj.status = status
        getAudioList(1, obj);
    })

    function preview(id, event) {
        event.stopPropagation()
        layer.msg("<div id='form9'></div>", {
            time: 0,
            closeBtn: 2,
            shade: 0.3,
            area: ['1300px', '530px']
        });
        ajax(url + "/" + id, 'get').then(function (res) {

            layui.laytpl($("#detail").html()).render(res.obj, function (html) {
                $("#form9").html(html);
                layui.form.render();
            })
        })
    }

    function getAudioList(curr, obj) {
        var columnObj = global.zTreeObj.getSelectedNodes()[0];
        obj.sign = 3;
        obj.dataId = global.editMetadataId;
        obj.tableid = columnObj.tableId;
        var jsonData = {
            "pager": {
                "current": curr,
                "size": tempSize
                , "sortProps": [
                    {
                        "key": "datetime",
                        "value": false
                    }
                ]
            },
            "picture": obj
        }
        ajax(service_prefix.resources, url + "/list", 'post', JSON.stringify(jsonData)).then(function (res) {
            layui.use('laypage', function () {
                var laypage = layui.laypage;

                //执行一个laypage实例
                laypage.render({
                    elem: 'test1'
                    , count: res.obj.total
                    , curr: res.obj.current
                    , limit: res.obj.size
                    , layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
                    , jump: function (obj, first) {
                        if (!first) {
                            curr = obj.curr
                            tempSize = obj.limit
                            var obj1 = {};
                            obj1.sign = 3
                            getAudioList(curr, obj1);
                        }
                    }
                });
            });
            layui.laytpl($("#audios").html()).render(res.obj.records, function (html) {
                $("#audio").html(html);
                layui.form.render();
            })
            layui.laytpl($("#audios1").html()).render(res.obj.records, function (html) {
                $("#audio1").html(html);
                layui.form.render();
            })
        })
    }

    var url = '/picture';

    function delaudios() {
        var data = document.getElementsByName("ids")
        var ids = "";
        var count = 0;
        for (var i in data) {
            if (data[i].checked) {
                if (count !== 0) {
                    ids += ",";
                }
                ids += data[i].value;
                count++;

            }

        }
        if (ids === "") {
            layer.alert("请选择要删除的音频")
            return false;
        }
        delaudio(ids)
    }

    function delaudio(ids) { //批量删除视频
        ajax("/picture/delByIds?ids=" + ids, "get").then(function (res) {
            console.log(res)
            if (res.success) {
                getAudioList(1, {})
            }
        })
    }

    function collect(id, event) {
        var src = event.target.getAttribute('src')
        if (src === "img/u582.png") {
            event.target.setAttribute('src', "img/u582_mouseOver.png")
            ajax(url + "/changeCollect?id=" + id, 'post').then(function (res) {
                console.log(res)
            })
        } else if (src === "img/u582_mouseOver.png") {
            event.target.setAttribute('src', "img/u582.png")
            ajax(url + "/changeCollect?id=" + id, 'post').then(function (res) {
                console.log(res)
            })
        }
    }

    function deleteAudios(id, event) {
        event.stopPropagation()
        layer.open({
            type: 1 //此处以iframe举例
            , title: '提示'
            , area: ['380px', '221px']
            , shade: 0.3
            , maxmin: true
            , content: "<div style='text-align:center;line-height:120px;'>确认要删除？</div>"
            , btn: ['确定', '取消'] //只是为了演示
            , btn2: function () {
                layer.closeAll();
            },
            yes: function () {
                ajax(url + "/delByIds?ids=" + id, 'get').then(function (res) {
                    if (res.success) {
                        layer.closeAll();
                        getAudioList(1, {})
                    }
                })
            }

        });
    }
</script>

<script>

    function add() {
        $('#list4').hide();
        $('#list5').show();
    }

    function edit() {
        $('#list3').hide();
        $('#list5').show();
    }

    function returnBack() {
        $("#list1").show();
        $('#list2').hide();
    }

    function returnBack1() {
        $("#list2").show();
        $('#list3').hide();
    }

    function returnBack2() {
        $("#list3").show();
        $('#list4').hide();
    }

    function returnBack3() {
        $("#list4").show();
        $('#list5').hide();
    }

    function returnBack4() {
        $("#list1").show();
        $('#list6').hide();
    }

    function returnBack5() {
        $("#list1").show();
        $('#list7').hide();
    }

    $("#change2").hover(function () {
        $(this).attr('src', './img/u6611_mouseOver.png');
    }, function () {
        $(this).attr('src', './img/u6611.png');
    })


    $('.img1').click(function () {
        if ($(this).find('img').attr('id') == 'change2') {
            $(this).find('img').attr('src', './img/u6611_mouseOver.png');
            $('#change1').attr('src', './img/u6616.png')
            $(".imgBox").hide()
            $(".imgBox1").show()
        } else if ($(this).find('img').attr('id') == 'change1') {
            $(this).find('img').attr('src', './img/u6616_mouseOver.png');
            $('#change2').attr('src', './img/u6611.png')
            $(".imgBox").show()
            $(".imgBox1").hide()
        }
    })


    layui.use('form', function () { //声明使用layUI的form
        var form = layui.form;
        form.render(); //刷新所有渲染效果，也可以单独熟悉某个效果
        //监听提交
        form.on('submit(formDemo)', function (data) {
            layer.msg(JSON.stringify(data.field));
            return false;
        });
    });

    layui.use('layer', function () { //独立版的layer无需执行这一句
        var layer = layui.layer; //独立版的layer无需执行这一句
        //触发事件

        var imgArr = [];

        $('.layui-btn').click(function (event) {
            event.stopPropagation();
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
        $('.img').click(function () {
            var othis = $(this), method = othis.data('method');
            active[method] ? active[method].call(this, othis) : '';
        });
    });

    active.preview = function () {
        layer.msg("<div id='form9'></div>", {
            time: 0,
            closeBtn: 2,
            shade: 0.3,
            area: ['1300px', '530px']
        });
        layui.laytpl($("#detail").html()).render({}, function (html) {
            $("#form9").html(html);
            layui.form.render();
        })
        $('.image').click(function () { //这个视频被点击后执行
            var img = $(this).attr('vpath');//获取视频预览图
            var video = $(this).attr('ipath');//获取视频路径
            $('.videos').html("<audio id=\"video\" poster='" + img + "' style='width: 795px;height:464px;' src='" + video + "' preload=\"auto\" controlsList=\"nodownload\" controls=\"controls\" autoplay=\"autoplay\"></audio><img onClick=\"close1()\" class=\"vclose\" src=\"gb.png\" width=\"25\" height=\"25\"/>");
            $('.videos').show();
        });

        function close1() {
            var v = document.getElementById('video');//获取视频节点
            $('.videos').hide();//点击关闭按钮关闭暂停视频
            v.pause();
            $('.videos').html();
        }
    }
    active.delete = function () {
        var that = this;
        //多窗口模式，层叠置顶
        layer.open({
            type: 1 //此处以iframe举例
            , title: '提示'
            , area: ['380px', '221px']
            , shade: 0.3
            , maxmin: true
            , content: "<div style='text-align:center;line-height:120px;'>确认要删除？</div>"
            , btn: ['确定', '取消'] //只是为了演示
            , btn2: function () {
                layer.closeAll();
            }

        });
    }
    active.setting = function () {
        layer.open({
            type: 1 //此处以iframe举例
            , title: '设置'
            , area: ['500px', '440px']
            , shade: 0.3
            , maxmin: true
            , content: "<div id='form1'></div>"

        });
        layui.laytpl($("#setForms").html()).render({}, function (html) {
            $("#form1").html(html);
            layui.form.render();
        })
        layui.form.on('radio(mp3Zcode)', function (data) {
            localStorage.setItem("mp3Zcode", data.value);
        })
    }

    var currNode = global.zTreeObj.getSelectedNodes()[0];
    active.upload = function () {
        $("#list1").hide();
        $('#list2').show();

        layui.use(['layer', 'element', 'form', 'upload'], function () {
            var layer = layui.layer,
                element = layui.element,
                form = layui.form,
                upload = layui.upload;

            //创建监听函数
            var xhrOnProgress = function (fun) {
                xhrOnProgress.onprogress = fun; //绑定监听
                //使用闭包实现监听绑
                return function () {
                    //通过$.ajaxSettings.xhr();获得XMLHttpRequest对象
                    var xhr = $.ajaxSettings.xhr();
                    //判断监听函数是否为函数
                    if (typeof xhrOnProgress.onprogress !== 'function')
                        return xhr;
                    //如果有监听函数并且xhr对象支持绑定时就把监听函数绑定上去
                    if (xhrOnProgress.onprogress && xhr.upload) {
                        xhr.upload.onprogress = xhrOnProgress.onprogress;
                    }
                    return xhr;
                }
            }
            var form = "mp3|wma|flac";
            var form1;
            if (localStorage.getItem("audioForm")) {
                form1 = localStorage.getItem("audioForm").split(",").join("|") + "|" + form;
            }

            var supForm = form1 || form
            var uploadFile = upload.render({
                elem: '#chooseFile', //绑定元素
                url: getAjaxUrl(service_prefix.resources, '/picture/radioupload?id=' + currNode.audioColumn), //上传接口
                exts: supForm,//限定上传类型
                xhr: xhrOnProgress,
                multiple: true,// 开启多文件上传
                drag: true, //是否允许拖拽上传
                size: 1024 * 0,//为0为不限制大小
                progress: function (value) { //上传进度回调 value进度值
                    element.progress('upload_progress', value + '%') //设置页面进度条
                },
                before: function (obj) {
                    $("#upload_progress").removeClass("layui-hide");
                },
                done: function (res, index, upload) {//在多文件上传中 每次成功将被调用一次
                    if (res) {//此处只用于单文件图片的上传，若为多图片多文件请做其他处理
                        ajax(service_prefix.resources, "/picture/" + res.id, "put", JSON.stringify({tableid:currNode.tableId,dataId:global.editMetadataId})).then(res => {
                            $("#list2").hide();
                            $("#list1").show();
                            getAudioList(1,{});
                        })
                    }
                },
                error: function (index, upload) {
                    //请求异常回调
                    layer.close(layer.index);
                    layer.confirm("上传失败，您是否要重新上传？", {
                        btn: ['确定', '取消'],
                        icon: 3,
                        title: "提示"
                    }, function () {
                        //关闭询问框
                        layer.closeAll();
                        //重新调用上传方法
                        uploadFile.upload();
                    })
                }
            });
        })
    }

</script>
<script type="text/html" id="setForms">
    <form class="layui-form" style="margin-top: 10px;">
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 25px;text-align: left">格式</label>
            <div class="layui-input-block" style="width: 330px;margin-left: 136px">
                <input type="text" class="layui-input" autocomplete="off">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"
                   style="padding:  9px 0px 9px 25px;text-align: left;width: 110px">数字音频接口</label>
            <div class="layui-input-block" style="width: 330px;margin-left: 136px">
                <select name="" id="">
                    <option value="">家用标准</option>
                    <option value="">专业标准</option>
                    <option value="">电脑标准</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 25px;text-align: left">视听技术</label>
            <div class="layui-input-block" style="width: 330px;margin-left: 136px">
                <select name="" id="">
                    <option value="">CD</option>
                    <option value="">VCD</option>
                    <option value="">MD</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"
                   style="padding:  9px 0px 9px 25px;text-align: left;width: 110px">默认MP3转码：</label>
            <div class="layui-input-block" style="width: 300px;margin-left: 140px;">
                <input type="radio" name="sex" value="是" title="是" lay-filter="mp3Zcode">
                <input type="radio" name="sex" value="否" title="否" lay-filter="mp3Zcode">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label" style="padding:  9px 0px 9px 25px;text-align: left">*版权所有</label>
            <div class="layui-input-block" style="width: 330px;margin-left: 136px" id="copyright">
                <select name="copyright" id="">
                    <option value="自主">自主</option>
                    <option value="原创">原创</option>
                    <option value="经授权">经授权</option>
                </select>
            </div>
        </div>
        <div class="layui-btn-container" style="margin: 35px 160px;">
            <button class="layui-btn" type="button">确定</button>
            <button class="layui-btn layui-btn-primary" onclick="layer.closeAll()" type="button">取消</button>
        </div>
    </form>
</script>
<script type="text/html" id='detail'>
    <div class='prev'>
        <i class='layui-icon layui-icon-left'></i>
    </div>
    <div class='box'>
        <div class='left'>
            <div class='image' style='position:relative;'>
                <img src="./img/u8901.png" alt="" style="width: 100%;height:100%">
                {{#if(d.mp3url){ }}
                <audio src="{{d.mp3url}}" preload="auto" controlsList="nodownload" controls="controls"
                       autoplay="autoplay"
                       style="position: absolute;left:200px;bottom:15px;"></audio>
                {{#} else if(!d.mp3url){ }}
                <audio src="{{d.url}}" preload="auto" controlsList="nodownload" controls="controls" autoplay="autoplay"
                       style="position: absolute;left:200px;bottom:15px;"></audio>
                {{#} }}

            </div>
        </div>
        <div class='rights'>
            <div class='layui-btn-container' style='margin-top:10px;'>

                <button class='layui-btn layui-btn-normal layui-btn-sm' style='margin-left:0px;'
                        onclick="downLoadAudio('{{d.id}}',event)">立即下载
                </button>
                <button class='layui-btn layui-btn-normal layui-btn-sm' style='margin-left:20px;'
                        onclick="deleteAudios('{{d.id}}',event)"><i class='layui-icon layui-icon-delete'></i></button>
            </div>
            <p style='margin-top:20px; color:#666;text-align:left;'>名称：{{d.name}}</p>
            <p style='margin-top:10px; color:#666;text-align:left'>大小：{{d.size}}KB</p>
            <p style='margin-top:10px; color:#666;text-align:left'>格式：{{d.form}}</p>
            <p style='margin-top:10px; color:#666;text-align:left'>上传时间：{{d.createTime}}</p>
            <p style='margin-top:10px; color:#666;text-align:left'>路径：{{d.url}}</p>
            <p style='margin-top:10px; color:#666;text-align:left'>来源：{{d.resc}}</p>
            <p style='margin-top:10px; color:#666;text-align:left;overflow: hidden'>版权所属：{{d.copyright}}</p>
            <p style='margin-top:10px; color:#666;text-align:left;overflow: hidden'>创建者：{{d.crUser}}</p>
            {{#if(d.status===0){ }}
            <p style='margin-top:10px; color:#666;text-align:left'>音频状态：新稿</p>
            {{#} else if(d.status===10){ }}
            <p style='margin-top:10px; color:#666;text-align:left'>音频状态：审核</p>
            {{#} else if(d.status===20){ }}
            <p style='margin-top:10px; color:#666;text-align:left'>音频状态：发布</p>
            {{#} }}
            <div class="layui-btn-container" style="margin-top: 20px;">
                {{#if(d.status!=10){ }}
                <button class='layui-btn' onclick="changeState('审核','{{d.id}}')">审核</button>
                {{#} }}
                {{#if(d.status!=20){ }}
                <button class='layui-btn' onclick="changeState('发布','{{d.id}}')">发布
                    {{#} }}
                    <button class='layui-btn layui-btn-danger' onclick="update('{{d.id}}')">修改</button>
            </div>
        </div>
    </div>
    </div>
    <div class='next'>
        <i class='layui-icon layui-icon-right'></i>
    </div>
</script>
<script>
    // layui.use('layer', function(){ //独立版的layer无需执行这一句
    //     var  layer = layui.layer; //独立版的layer无需执行这一句
    var ids = "";

    function update(id) {
        ajax(url + "/" + id, 'get').then(function (res) {
            if (res.success) {
                layer.closeAll();
                $("#list1").hide();
                $("#list7").show();
                ids = id;
                layui.laytpl($("#inner").html()).render(res.obj, function (html) {
                    $("#inner5").html(html);
                    layui.form.val('audioInfo', res.obj)
                })

            }
        })
    }

    layui.form.on("submit(confirms)", function (data) {
        console.log(data.field, ids)
        ajax(url + "/" + ids, "put", JSON.stringify(data.field)).then(function (res) {
            if (res.success) {
                $("#list7").hide();
                $("#list1").show();
                getAudioList(1, {})
            }
        })
    })
</script>
<script type="text/html" id="inner">
    <div class='left'
         style="width: 700px;height:500px;background: #f5f5f5;padding: 20px;margin-top: 40px;display: inline-block">
        <div class='image' style="height: 484px;width: 695px;position: relative;">
            <img src="./img/u8901.png" alt="" style="width: 100%;height:100%">
            {{#if(d.mp3url){ }}
            <audio src="{{d.mp3url}}" preload="auto" controlsList="nodownload" controls="controls" autoplay="autoplay"
                   style="position: absolute;left:200px;bottom:15px;"></audio>
            {{#} else if(!d.mp3url){ }}
            <audio src="{{d.url}}" preload="auto" controlsList="nodownload" controls="controls" autoplay="autoplay"
                   style="position: absolute;left:200px;bottom:15px;"></audio>
            {{#} }}

        </div>
    </div>
    <div class="infoBox"
         style="width: 450px;height:630px;border-left:1px solid #ccc;position: absolute;top:40px;right:0;">
        <form class="layui-form" id='form3' lay-filter="audioInfo">
            <button class="layui-btn layui-btn-normal" style="width: 310px;margin:20px 0 20px 50px;" lay-submit
                    lay-filter="confirms" type="button">确定
            </button>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">音频名称</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" placeholder="请输入内容" name="name">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">*版权归属</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" name="copyright">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">来源</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" placeholder="请输入内容" name="resc">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">*描述</label>
                <div class="layui-input-block" style="width:320px;">
                    <textarea class="layui-textarea" style="border: 1px solid #ccc" name="description"></textarea>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">文件夹路径</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" placeholder="请输入内容" name="url">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">格式</label>
                <div class="layui-input-block" style="width:320px;">
                    <select name="form" id="">
                        <option value="mp3" selected>MP3</option>
                        <option value="wav">WAV</option>
                        <option value="asf">ASF</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">文件大小</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" name="size">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">时长</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" name="length">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="text-align: left;">上传时间</label>
                <div class="layui-input-block" style="width:320px;">
                    <input type="text" class="layui-input" name="createTime">
                </div>
            </div>
        </form>

    </div>
</script>

<script type="text/html" id="columnDetailTpl">
    <button class="layui-btn" type="button" onclick="editColumn2('{{d.id}}')">修改栏目</button>
    <table class="layui-table" style="width: 75%" lay-even="" lay-skin="row" id="info">
        <colgroup>
            <col width="20%">
            <col width="">
            <col>
        </colgroup>
        <tbody>
        <tr>
            <td>状态：</td>
            <td>{{d.status==0?"启用":"停用"}}</td>
        </tr>
        <tr>
            <td>所属站点：</td>
            <td id="columnSiteName"></td>
        </tr>
        <tr>
            <td>唯一标识：</td>
            <td>{{d.skuNumber}}</td>
        </tr>
        <tr>
            <td>栏目名称：</td>
            <td>{{d.name}}</td>
        </tr>
        <tr>
            <td>首页展示模板：</td>
            <td style="cursor: pointer;" onclick="editTemplate('{{d.listtpl}}')">{{d.listtplName}}</td>
        </tr>
        <tr>
            <td>细览编辑模板：</td>
            <td style="cursor: pointer;" onclick="editTemplate('{{d.edittpl}}')">{{d.edittplName}}</td>
        </tr>
        <tr>
            <td>细览展示模板：</td>
            <td style="cursor: pointer;" onclick="editTemplate('{{d.detailtpl}}')">{{d.detailtplName}}</td>
        </tr>
        <tr>
            <td>元数据名称：</td>
            <td style="cursor: pointer;" id="columnTableName" onclick="showTab('metadataFieldTab');"></td>
        </tr>
        <tr>
            <td>发布地址：</td>
            <td><a target="_blank" href="/pub{{d.chnlDataPath}}/list.html">/pub{{d.chnlDataPath}}/list.html</a></td>
        </tr>
        </tbody>
    </table>
</script>
<script type="text/html" id="templetTpl">
    <form class="layui-form" lay-filter="templetForm">
        <div class="layui-card">
            <div class="layui-card-body" style="padding: 25px 15px;    height: 780px;">

                <div class="layui-form-item form-item-inline" style="width: 500px">
                    <label class="layui-form-label">模板名称:</label>
                    <div class="layui-input-block">
                        <input type="text" name="tempname" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">模板类型:</label>
                    <div class="layui-input-block">
                        <select name="temptype" class="layui-input" required lay-verify="required">
                            <option value="1">概览模板</option>
                            <option value="2">细览模板</option>
                            <option value="3">嵌套模板</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">输出文件名:</label>
                    <div class="layui-input-block">
                        <input type="text" name="outputfilename" placeholder="请输入" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">扩展名:</label>
                    <div class="layui-input-block">
                        <input type="text" name="tempext" placeholder="请输入" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item form-item-inline">
                    <label class="layui-form-label">站点:</label>
                    <div class="layui-input-block">
                        <span>{{d.siteName}}</span>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">模板描述:</label>
                    <div class="layui-input-block" style="display: inline-block;margin-left: 0">
                        <textarea class="layui-textarea" style="height: 55px;min-height: 0;width: 1010px;"
                                  name="tempdesc"></textarea>
                    </div>
                    <div class="layui-upload" style="    position: absolute;display: inline-block;
    margin-left: 50px;
    margin-top: 12px;">
                        <button type="button" class="layui-btn" id="test1" style="display: inline-block">上传模板缩略图
                        </button>
                        <div class="layui-upload-list" style="display: inline-block;position: absolute;
    left: 140px;
    top: -20px;    height: 50px;
    width: 120px;
    border: 1px solid;
    margin-left: 10px">
                            <img class="layui-upload-img" id="demos1" style="width: 100%;height: 100%">
                            <p id="demoText"></p>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">模板文本:</label>
                    <div class="layui-input-block">
                        <textarea class="layui-textarea"
                                  style="height: 673px;padding-top: 7px;line-height: 18px!important;" name="temphtml"
                                  id="text1"></textarea>
                    </div>
                </div>

            </div>
        </div>
        <div class="button-bar">
            <button class="layui-btn" lay-submit lay-filter="addTemplet">提交</button>
            <button class="layui-btn" type="button" data-type="close">返回</button>
        </div>
        <input type="hidden" name="id">
        <input type="hidden" name="siteid">
    </form>
</script>
<script type="text/html" id="columnTpl">
    <form class="layui-form" lay-filter="columnForm">
        <div class="layui-card-body">
            <div class="layui-form-item">
                <label class="layui-form-label">状态:</label>
                <div class="layui-input-block">
                    <input type="radio" name="status" checked value="0" title="启用">
                    <input type="radio" name="status" value="1" title="停用">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">所属站点:</label>
                <div class="layui-input-block">
                    <span>{{d.siteName}}</span>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">父栏目:</label>
                <div class="layui-input-block">
                    <span>{{d.parentName}}</span>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">栏目类型:</label>
                <div class="layui-input-block">
                    <select name="" class="layui-input" required lay-verify="required">
                        <option value="1">普通栏目</option>
                        <option value="2">图片新闻</option>
                        <option value="3">头条栏目</option>
                        <option value="4">链接栏目</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">唯一标识:</label>
                <div class="layui-input-block">
                    <input type="text" name="skuNumber" required lay-verify="required" placeholder="请输入"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">栏目名称:</label>
                <div class="layui-input-block">
                    <input type="text" name="name" required lay-verify="required" placeholder="请输入"
                           autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">前一个栏目:</label>
                <div class="layui-input-block">
                    <select class="layui-input" id="chnlOrder" name="chnlOrder">
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">首页模板:</label>
                <div class="layui-input-block">
                    <span onclick="selectTemp('listtpl')" style="cursor: pointer;">
                        <i class="layui-icon layui-icon-app"></i>
                        <span id="listtpl">{{d.listtplName?d.listtplName:"请选择模板"}}</span>
                    </span>
                    <input type="hidden" name="listtpl">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">编辑模板:</label>
                <div class="layui-input-block">
                    <span onclick="selectTemp('edittpl')" style="cursor: pointer;">
                        <i class="layui-icon layui-icon-app"></i>
                        <span id="edittpl">{{d.edittplName?d.edittplName:"请选择模板"}}</span>
                    </span>
                    <input type="hidden" name="edittpl">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">细览模板:</label>
                <div class="layui-input-block">
                    <span onclick="selectTemp('detailtpl')" style="cursor: pointer;">
                        <i class="layui-icon layui-icon-app"></i>
                        <span id="detailtpl">{{d.detailtplName?d.detailtplName:"请选择模板"}}</span>
                    </span>
                    <input type="hidden" name="detailtpl">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">元数据:</label>
                <div class="layui-input-block">
                    <select name="tableId" class="layui-input" id="tableId">
                        <option value="" selected>请选择</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">json列表:</label>
                <div class="layui-input-block">
                    <input class="layui-input" value="新建，查询，修改，删除，删除多个" disabled>
                </div>
            </div>
            <input type="hidden" name="id">
            <div class="button-bar">
                <button type="button" class="layui-btn" lay-submit lay-filter="addColumn">确定</button>
                <button type="button" class="layui-btn layui-btn-primary" onclick="layer.closeAll();">取消</button>
            </div>
        </div>
        <input type="hidden" name="siteId">
        <input type="hidden" name="parentId">
        <input type="hidden" name="id">
    </form>
</script>
<script type="text/html" id="columnListTmpl">
    {{#layui.each(d, function(index, item){}}
    <li>
        <form class="layui-form" action="">
            <div class="layui-form-item" pane="">
                <div class="layui-input-block">
                    <input type="checkbox" name="ids" lay-skin="primary" id="check" value="{{item.id}}">
                </div>
            </div>
            <div class="chanelName">{{item.name}}</div>
        </form>
        <div class="bottom">
            <img src="./img/u5722.png" alt="" onclick="editColumn('{{item.id}}')">
            <img src="./img/u5725.png" alt="" onclick="getColumnById('{{item.id}}')">
            <img onclick="delColumn1('{{item.id}}',1)" src="./img/u5729.png" alt="" srcset="">
        </div>
    </li>
    {{#}) }}
    <li>
        <button data-type="showAddColumn" type="button" class="layui-btn"></button>
    </li>
</script>
</body>

</html>